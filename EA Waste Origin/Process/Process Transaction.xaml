<Activity mc:Ignorable="sap sap2010" x:Class="Process_Transaction_2" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:njl="clr-namespace:Newtonsoft.Json.Linq;assembly=Newtonsoft.Json" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:sc="clr-namespace:System.Collections;assembly=mscorlib" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Diagnostics;assembly=System" xmlns:sd1="clr-namespace:System.Data;assembly=System.Data" xmlns:sn="clr-namespace:System.Net;assembly=System" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:str="clr-namespace:System.Text.RegularExpressions;assembly=System" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:us="clr-namespace:UiPathTeam.SharePoint;assembly=UiPathTeam.SharePoint" xmlns:usa="clr-namespace:UiPathTeam.SharePoint.Activities;assembly=UiPathTeam.SharePoint.Activities" xmlns:usal="clr-namespace:UiPathTeam.SharePoint.Activities.Libraries;assembly=UiPathTeam.SharePoint.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property sap2010:Annotation.AnnotationText="Transaction item to be processed." Name="in_TransactionItem" Type="InArgument(snm:MailMessage)" />
    <x:Property Name="io_arrExitPoint" Type="InOutArgument(s:Int32[])" />
    <x:Property Name="io_swProcessingTimer" Type="InOutArgument(sd:Stopwatch)" />
    <x:Property sap2010:Annotation.AnnotationText="Dictionary structure to store configuration data of the process (settings, constants and assets)." Name="io_Config" Type="InOutArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="io_arrCaseID" Type="InOutArgument(s:String[])" />
    <x:Property Name="in_CredDMS" Type="InArgument(sn:NetworkCredential)" />
    <x:Property Name="in_strWorkingFolder" Type="InArgument(x:String)" />
    <x:Property Name="in_TransactionNumber" Type="InArgument(x:Int32)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1236,1594</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>Process_Transaction_2_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="60">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Runtime.Serialization</x:String>
      <x:String>System.Activities.DynamicUpdate</x:String>
      <x:String>System.Runtime.InteropServices</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>UiPath.Platform.ObjectLibrary</x:String>
      <x:String>System.Net</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.CV</x:String>
      <x:String>UiPath.Shared.ObjectLibrary</x:String>
      <x:String>UiPath.CV.Activities</x:String>
      <x:String>UiPath.CV.Activities.Interfaces</x:String>
      <x:String>UiPath.Excel</x:String>
      <x:String>UiPath.Excel.Activities</x:String>
      <x:String>UiPath.Core.Activities.Orchestrator</x:String>
      <x:String>System.ComponentModel</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>UiPath.DataTableUtilities</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
      <x:String>UiPath.Mail.Activities</x:String>
      <x:String>UiPath.Shared.Activities.Business</x:String>
      <x:String>UiPath.Web</x:String>
      <x:String>UiPath.Platform.ResourceHandling</x:String>
      <x:String>UiPath.Web.Activities</x:String>
      <x:String>System.Dynamic</x:String>
      <x:String>System.Collections.Specialized</x:String>
      <x:String>UiPath.UIAutomationCore.Contracts</x:String>
      <x:String>UiPath.UIAutomationNext.Enums</x:String>
      <x:String>UiPath.Mail.Outlook.Activities</x:String>
      <x:String>UiPathTeam.SharePoint</x:String>
      <x:String>Microsoft.SharePoint.Client</x:String>
      <x:String>UiPathTeam.SharePoint.Activities</x:String>
      <x:String>UiPathTeam.SharePoint.Activities.Libraries</x:String>
      <x:String>UiPath.Mail</x:String>
      <x:String>Pop_Ups</x:String>
      <x:String>Credentials</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="96">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Reflection.Metadata</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Platform</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.CV</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.CV.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Excel.Activities.Design</AssemblyReference>
      <AssemblyReference>NPOI</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities.Design</AssemblyReference>
      <AssemblyReference>UiPath.Mail.Activities</AssemblyReference>
      <AssemblyReference>UiPath.OCR.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationCore</AssemblyReference>
      <AssemblyReference>UiPath.Web</AssemblyReference>
      <AssemblyReference>UiPath.Web.Activities</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>UiPath.UIAutomationNext</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint</AssemblyReference>
      <AssemblyReference>Microsoft.SharePoint.Client</AssemblyReference>
      <AssemblyReference>Microsoft.SharePoint.Client.Runtime</AssemblyReference>
      <AssemblyReference>OfficeDevPnP.Core</AssemblyReference>
      <AssemblyReference>UiPathTeam.SharePoint.Activities</AssemblyReference>
      <AssemblyReference>Pop Ups</AssemblyReference>
      <AssemblyReference>Credentials</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Flowchart sap2010:Annotation.AnnotationText="Invoke major steps of the business process, which are usually implemented by multiple subworkflows.&#xA;&#xA;If a BusinessRuleException is thrown, the transaction is skipped. &#xA;If another kind of exception occurs, the current transaction can be retried. " sap:VirtualizedContainerService.HintSize="673.333333333333,1529.33333333333" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:Int32" Name="intRowNo" />
      <Variable x:TypeArguments="x:String" Name="strFacilityPostcode" />
      <Variable x:TypeArguments="x:String" Name="strPermitNumber" />
      <Variable x:TypeArguments="x:String" Name="strQPNumber" />
      <Variable x:TypeArguments="x:String" Name="strCustomerOperatorName" />
      <Variable x:TypeArguments="x:String" Name="strFacilityName" />
      <Variable x:TypeArguments="x:String" Name="strFacilityAddress" />
      <Variable x:TypeArguments="x:String" Name="strProposedVolume" />
      <Variable x:TypeArguments="x:String" Name="strQPName" />
      <Variable x:TypeArguments="x:String" Name="strRoute" />
      <Variable x:TypeArguments="x:String" Name="strRecieverHubTreatment" />
      <Variable x:TypeArguments="x:String" Name="strReceiverSite" />
      <Variable x:TypeArguments="x:String" Name="strAdditionalDonorSite" />
      <Variable x:TypeArguments="x:String" Name="strAdditionalReceiverSite" />
      <Variable x:TypeArguments="x:String" Name="strAuthorityAddress" />
      <Variable x:TypeArguments="x:String" Name="strAuthorityName" />
      <Variable x:TypeArguments="x:String" Name="strDonorSite" />
      <Variable x:TypeArguments="x:String" Name="strSiteofOriginAddress" />
      <Variable x:TypeArguments="x:String" Name="strAreaEmail" />
      <Variable x:TypeArguments="sd1:DataTable" Name="datLineToAdd" />
      <Variable x:TypeArguments="x:Int32" Name="intNextPermit" />
      <Variable x:TypeArguments="ui:Browser" Name="broswerDMS" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,74.6666666666667</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">300,77.7 300,127.7</av:PointCollection>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        <x:Double x:Key="Width">639.59999999999991</x:Double>
        <x:Double x:Key="Height">1414.7520000000002</x:Double>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID10</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">200,484.1</av:Point>
          <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">300,552.9 300,602.9</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Open DMS" sap:VirtualizedContainerService.HintSize="1082,2340.66666666667" sap2010:WorkflowViewState.IdRef="Sequence_1">
        <Sequence.Variables>
          <Variable x:TypeArguments="x:Boolean" Name="booExists" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <ui:ReportStatus DisplayName="Report Status - Opening DMS" sap:VirtualizedContainerService.HintSize="1040,68" sap2010:WorkflowViewState.IdRef="ReportStatus_10" StatusText="[&quot;Copying Spreadsheets from Shared Drive...&quot;]" />
        <ui:UiElementExists DisplayName="Element Exists - DMS" Exists="[booExists]" sap:VirtualizedContainerService.HintSize="1040,106" sap2010:WorkflowViewState.IdRef="UiElementExists_3">
          <ui:UiElementExists.Target>
            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="bf98262d-0a5c-4bbe-a7a9-38386de9f329" InformativeScreenshot="09ce1155887d632654bba197854ff157" Selector="&lt;html app='msedge.exe' title='Document Management Service - Search' /&gt;&lt;webctrl aaname='Document Management Service' parentid='spSiteHeader' tag='A' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
          </ui:UiElementExists.Target>
        </ui:UiElementExists>
        <If Condition="[booExists=FALSE]" DisplayName="If DMS is not Open" sap:VirtualizedContainerService.HintSize="1040,1994.66666666667" sap2010:WorkflowViewState.IdRef="If_1">
          <If.Then>
            <ui:OpenBrowser AutomaticallyDownloadWebDriver="{x:Null}" CommunicationMethod="{x:Null}" Hidden="{x:Null}" NewSession="{x:Null}" Private="{x:Null}" BrowserType="Edge" DisplayName="Open Browser - DMS" sap:VirtualizedContainerService.HintSize="560,1830.66666666667" sap2010:WorkflowViewState.IdRef="OpenBrowser_3" UiBrowser="[broswerDMS]" Url="[io_Config(&quot;DMS - URL&quot;).ToString]">
              <ui:OpenBrowser.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                  </ActivityAction.Argument>
                  <Sequence sap:VirtualizedContainerService.HintSize="526,1728" sap2010:WorkflowViewState.IdRef="Sequence_14">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="ui:Window" Name="Window" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:UiElementExists DisplayName="Element Exists - DMS" Exists="[booExists]" sap:VirtualizedContainerService.HintSize="484,106" sap2010:WorkflowViewState.IdRef="UiElementExists_5">
                      <ui:UiElementExists.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="bf98262d-0a5c-4bbe-a7a9-38386de9f329" InformativeScreenshot="09ce1155887d632654bba197854ff157" Selector="&lt;html app='msedge.exe' title='Document Management Service - Search' /&gt;&lt;webctrl aaname='Document Management Service' parentid='spSiteHeader' tag='A' /&gt;" TimeoutMS="3000" WaitForReady="COMPLETE" />
                      </ui:UiElementExists.Target>
                    </ui:UiElementExists>
                    <ui:WindowScope SearchScope="{x:Null}" TimeoutMS="{x:Null}" Window="{x:Null}" ApplicationWindow="[Window]" DisplayName="Attach Window - Edge" sap:VirtualizedContainerService.HintSize="484,168" sap2010:WorkflowViewState.IdRef="WindowScope_2" InformativeScreenshot="f518d960f227f72712a611f4279574b6" Selector="&lt;wnd app='msedge.exe' cls='Chrome_WidgetWin_1' title='*' /&gt;">
                      <ui:WindowScope.Body>
                        <ActivityAction x:TypeArguments="x:Object">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                          </ActivityAction.Argument>
                          <ui:MaximizeWindow DisplayName="Maximize Window" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MaximizeWindow_3" Window="[Window]" />
                        </ActivityAction>
                      </ui:WindowScope.Body>
                    </ui:WindowScope>
                    <If Condition="[booExists=FALSE]" DisplayName="If login exists:" sap:VirtualizedContainerService.HintSize="484,1282" sap2010:WorkflowViewState.IdRef="If_2">
                      <If.Then>
                        <ui:BlockUserInput BlockType="All" ContinueOnError="True" DisplayName="Block User Input" sap:VirtualizedContainerService.HintSize="436.666666666667,1090.66666666667" sap2010:WorkflowViewState.IdRef="BlockUserInput_2" KeyModifiers="Alt" SpecialKey="True" TimeoutMS="15000">
                          <ui:BlockUserInput.Body>
                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,962.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_9">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Use another account'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_11" KeyModifiers="None" MouseButton="BTN_LEFT" SimulateClick="False">
                                <ui:Click.CursorPosition>
                                  <ui:CursorPosition Position="Center">
                                    <ui:CursorPosition.OffsetX>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetX>
                                    <ui:CursorPosition.OffsetY>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetY>
                                  </ui:CursorPosition>
                                </ui:Click.CursorPosition>
                                <ui:Click.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="b5da7413-3d59-4a64-b22a-0d712ea075f7" InformativeScreenshot="01f809e8dc3d603543308ff83e4b1e83" Selector="&lt;webctrl id='otherTileText' tag='DIV' /&gt;" WaitForReady="COMPLETE">
                                    <ui:Target.TimeoutMS>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:Target.TimeoutMS>
                                  </ui:Target>
                                </ui:Click.Target>
                              </ui:Click>
                              <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Username" sap:VirtualizedContainerService.HintSize="333.6,135.2" sap2010:WorkflowViewState.IdRef="SetValue_3" Text="[in_CredDMS.username.tostring]">
                                <ui:SetValue.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="7003e596-51d8-4bd3-a510-c5aa79990190" InformativeScreenshot="00fd3403744fb4de002cc841287223c6" Selector="&lt;webctrl id='i0116' tag='INPUT' /&gt;">
                                    <ui:Target.TimeoutMS>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:Target.TimeoutMS>
                                    <ui:Target.WaitForReady>
                                      <InArgument x:TypeArguments="ui:WaitForReady" />
                                    </ui:Target.WaitForReady>
                                  </ui:Target>
                                </ui:SetValue.Target>
                              </ui:SetValue>
                              <ui:Click AlterIfDisabled="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DelayBefore="1000" DisplayName="Click 'Next'" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="Click_17" KeyModifiers="None" MouseButton="BTN_LEFT">
                                <ui:Click.CursorPosition>
                                  <ui:CursorPosition Position="Center">
                                    <ui:CursorPosition.OffsetX>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetX>
                                    <ui:CursorPosition.OffsetY>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetY>
                                  </ui:CursorPosition>
                                </ui:Click.CursorPosition>
                                <ui:Click.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="4676d6f6-a40e-4791-ad5d-5fb8a10d2395" InformativeScreenshot="52b363b38cb04060ddba1be89087e13b" Selector="&lt;html app='msedge.exe' title='Sign in to your account' /&gt;&lt;webctrl id='idSIButton9' tag='INPUT' /&gt;" WaitForReady="COMPLETE">
                                    <ui:Target.TimeoutMS>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:Target.TimeoutMS>
                                  </ui:Target>
                                </ui:Click.Target>
                              </ui:Click>
                              <ui:TypeSecureText AlterIfDisabled="{x:Null}" ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" Activate="True" DelayBetweenKeys="15" DisplayName="Type Secure Text - Password" EmptyField="True" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="TypeSecureText_3" SecureText="[in_CredDMS.SecurePassword]" SimulateType="True">
                                <ui:TypeSecureText.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="a80137a4-7fc7-4af7-91ca-142f40820ece" InformativeScreenshot="6ca53f8d99e951b0919375f02862d0ed" Selector="&lt;webctrl id='i0118' tag='INPUT' /&gt;">
                                    <ui:Target.TimeoutMS>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:Target.TimeoutMS>
                                    <ui:Target.WaitForReady>
                                      <InArgument x:TypeArguments="ui:WaitForReady" />
                                    </ui:Target.WaitForReady>
                                  </ui:Target>
                                </ui:TypeSecureText.Target>
                              </ui:TypeSecureText>
                              <ui:Click AlterIfDisabled="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" ClickType="CLICK_DOUBLE" DelayBefore="1000" DisplayName="Click 'Sign In'" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="Click_12" KeyModifiers="None" MouseButton="BTN_LEFT" SimulateClick="False">
                                <ui:Click.CursorPosition>
                                  <ui:CursorPosition Position="Center">
                                    <ui:CursorPosition.OffsetX>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetX>
                                    <ui:CursorPosition.OffsetY>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetY>
                                  </ui:CursorPosition>
                                </ui:Click.CursorPosition>
                                <ui:Click.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="6caff0e5-1c05-4cc3-9709-324941e7b87e" InformativeScreenshot="fc3253c24ff345aab9c0c010a80c5c10" Selector="&lt;html app='msedge.exe' title='Sign in to your account' /&gt;&lt;webctrl id='idSIButton9' tag='INPUT' /&gt;" WaitForReady="COMPLETE">
                                    <ui:Target.TimeoutMS>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:Target.TimeoutMS>
                                  </ui:Target>
                                </ui:Click.Target>
                              </ui:Click>
                              <ui:Click AlterIfDisabled="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayBefore="1000" DisplayName="Click 'Yes'" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="Click_13" KeyModifiers="None" MouseButton="BTN_LEFT" SimulateClick="False">
                                <ui:Click.CursorPosition>
                                  <ui:CursorPosition Position="Center">
                                    <ui:CursorPosition.OffsetX>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetX>
                                    <ui:CursorPosition.OffsetY>
                                      <InArgument x:TypeArguments="x:Int32" />
                                    </ui:CursorPosition.OffsetY>
                                  </ui:CursorPosition>
                                </ui:Click.CursorPosition>
                                <ui:Click.Target>
                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="3d163af1-3419-45bd-990f-ba7819826543" InformativeScreenshot="2b5e9766a6422cd82b75d6df4ba2a856" Selector="&lt;html app='msedge.exe' title='Sign in to your account' /&gt;&lt;webctrl id='idSIButton9' tag='INPUT' /&gt;" TimeoutMS="3000" WaitForReady="COMPLETE" />
                                </ui:Click.Target>
                              </ui:Click>
                            </Sequence>
                          </ui:BlockUserInput.Body>
                        </ui:BlockUserInput>
                      </If.Then>
                    </If>
                  </Sequence>
                </ActivityAction>
              </ui:OpenBrowser.Body>
            </ui:OpenBrowser>
          </If.Then>
          <If.Else>
            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" TimeoutMS="{x:Null}" BrowserType="Edge" DisplayName="Attach Browser - Edge" sap:VirtualizedContainerService.HintSize="434,296.666666666667" sap2010:WorkflowViewState.IdRef="BrowserScope_2" InformativeScreenshot="f518d960f227f72712a611f4279574b6" Selector="&lt;html app='msedge.exe' htmlwindowname='{}' title='Document Management Service - Search' /&gt;" UiBrowser="[broswerDMS]">
              <ui:BrowserScope.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,150.666666666667" sap2010:WorkflowViewState.IdRef="Sequence_99">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:NavigateTo Browser="{x:Null}" DisplayName="Navigate To homepage" sap:VirtualizedContainerService.HintSize="334,58.6666666666667" sap2010:WorkflowViewState.IdRef="NavigateTo_1" Url="[io_Config(&quot;DMS - URL&quot;).ToString]" />
                  </Sequence>
                </ActivityAction>
              </ui:BrowserScope.Body>
            </ui:BrowserScope>
          </If.Else>
        </If>
      </Sequence>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID0">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">200,602.9</av:Point>
              <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">300,671.7 300,721.7</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Create New Permit Folder" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_7">
            <Sequence.Variables>
              <Variable x:TypeArguments="x:Boolean" Name="booElementExists" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:ReportStatus DisplayName="Report Status - Creating Permit Folder" sap:VirtualizedContainerService.HintSize="562.4,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_11" StatusText="[&quot;Creating permit folder...&quot;]" />
            <ui:BrowserScope SearchScope="{x:Null}" Selector="{x:Null}" TimeoutMS="{x:Null}" UiBrowser="{x:Null}" Browser="[broswerDMS]" BrowserType="Edge" DisplayName="Attach Browser - DMS" sap:VirtualizedContainerService.HintSize="562.4,3884.8" sap2010:WorkflowViewState.IdRef="BrowserScope_1" InformativeScreenshot="b73d30b06b85fac3a192a9a7207870fa">
              <ui:BrowserScope.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="528.8,3737.6" sap2010:WorkflowViewState.IdRef="Sequence_10">
                    <Sequence.Variables>
                      <Variable x:TypeArguments="x:Boolean" Name="booExists" />
                    </Sequence.Variables>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Create a new permit folder'" sap:VirtualizedContainerService.HintSize="487.2,107.2" sap2010:WorkflowViewState.IdRef="Click_14" KeyModifiers="None" MouseButton="BTN_LEFT" SimulateClick="True">
                      <ui:Click.CursorPosition>
                        <ui:CursorPosition Position="Center">
                          <ui:CursorPosition.OffsetX>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetX>
                          <ui:CursorPosition.OffsetY>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:CursorPosition.OffsetY>
                        </ui:CursorPosition>
                      </ui:Click.CursorPosition>
                      <ui:Click.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d0d6270c-b612-4368-9ad1-5f6969fa296a" InformativeScreenshot="26182cf01e688e0d20b20ea2f4ffd872" Selector="&lt;webctrl parentid='spLeftNav' parentname='Create a new permit folder' tag='SPAN' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:Click.Target>
                    </ui:Click>
                    <Assign DisplayName="Set booExists to FALSE" sap:VirtualizedContainerService.HintSize="487.2,60" sap2010:WorkflowViewState.IdRef="Assign_1">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:Boolean">[booExists]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                      </Assign.Value>
                    </Assign>
                    <ui:InterruptibleDoWhile Condition="[booExists=False]" DisplayName="Check for page loading:" sap:VirtualizedContainerService.HintSize="487.2,274.4" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_1">
                      <ui:InterruptibleDoWhile.Body>
                        <ui:UiElementExists DisplayName="Element Exists - Permit No." Exists="[booExists]" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="UiElementExists_4">
                          <ui:UiElementExists.Target>
                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="74e7a952-9617-4ec1-9e52-df6690a1f7fa" InformativeScreenshot="a7bf926a3c98ff39d3a21bf6bb149f2a" Selector="&lt;webctrl aaname='Permit Number' tag='LABEL' /&gt;" TimeoutMS="3000">
                              <ui:Target.WaitForReady>
                                <InArgument x:TypeArguments="ui:WaitForReady" />
                              </ui:Target.WaitForReady>
                            </ui:Target>
                          </ui:UiElementExists.Target>
                        </ui:UiElementExists>
                      </ui:InterruptibleDoWhile.Body>
                    </ui:InterruptibleDoWhile>
                    <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Permit Number" sap:VirtualizedContainerService.HintSize="487.2,135.2" sap2010:WorkflowViewState.IdRef="SetValue_6" Text="[strPermitNumber]">
                      <ui:SetValue.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="bc8f45c5-239c-4fb4-a454-d79b096867c1" InformativeScreenshot="69531089caace38964ac3424cba46613" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl tag='INPUT' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SetValue.Target>
                    </ui:SetValue>
                    <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Other Reference" sap:VirtualizedContainerService.HintSize="487.2,135.2" sap2010:WorkflowViewState.IdRef="SetValue_7" Text="[strQPNumber]">
                      <ui:SetValue.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="376d6c3e-0765-40ba-bf88-6ed17f7d1e99" InformativeScreenshot="b6bbafe73e9efd94b0e55d439b6adf11" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl id='TextField36' tag='INPUT' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SetValue.Target>
                    </ui:SetValue>
                    <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Customer Operator Name" sap:VirtualizedContainerService.HintSize="487.2,135.2" sap2010:WorkflowViewState.IdRef="SetValue_8" Text="[strCustomerOperatorName]">
                      <ui:SetValue.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="136e1c1e-84d8-4373-a3e1-2f2802bb78e7" InformativeScreenshot="0ab80863546b3104d76d600ce0b14652" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl id='TextField42' tag='INPUT' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SetValue.Target>
                    </ui:SetValue>
                    <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Facility Name" sap:VirtualizedContainerService.HintSize="487.2,135.2" sap2010:WorkflowViewState.IdRef="SetValue_5" Text="[strFacilityName]">
                      <ui:SetValue.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="50793b83-b2f1-40b0-b278-2cc5fc6d7f5d" InformativeScreenshot="4fe3322d8aaa8cff948896b8b422d8d9" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl id='TextField45' tag='INPUT' name='txtSiteName' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SetValue.Target>
                    </ui:SetValue>
                    <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Facility Address" sap:VirtualizedContainerService.HintSize="487.2,135.2" sap2010:WorkflowViewState.IdRef="SetValue_11" Text="[strFacilityAddress]">
                      <ui:SetValue.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d400b773-6839-4dc0-8dbf-cf8d5959d55c" InformativeScreenshot="791e177b3dca308a4e39bbe334ca9602" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl id='TextField48' tag='INPUT' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SetValue.Target>
                    </ui:SetValue>
                    <ui:SetValue AlterIfDisabled="{x:Null}" ContinueOnError="{x:Null}" DelayAfter="{x:Null}" DelayBefore="{x:Null}" DisplayName="Set Text - Facility Postcode" sap:VirtualizedContainerService.HintSize="487.2,135.2" sap2010:WorkflowViewState.IdRef="SetValue_10" Text="[strFacilityPostcode]">
                      <ui:SetValue.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="40c0d839-8226-4623-ad55-bb3f40188987" InformativeScreenshot="e79ecaa9e75085ce43aac3bcb29e5f03" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl id='TextField51' tag='INPUT' /&gt;">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                          <ui:Target.WaitForReady>
                            <InArgument x:TypeArguments="ui:WaitForReady" />
                          </ui:Target.WaitForReady>
                        </ui:Target>
                      </ui:SetValue.Target>
                    </ui:SetValue>
                    <ui:BlockUserInput TimeoutMS="{x:Null}" BlockType="All" DisplayName="Block User Input" sap:VirtualizedContainerService.HintSize="487.2,852.8" sap2010:WorkflowViewState.IdRef="BlockUserInput_3" KeyModifiers="Alt" SpecialKey="True">
                      <ui:BlockUserInput.Body>
                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="375.2,725.6" sap2010:WorkflowViewState.IdRef="Sequence_85">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:TypeInto AlterIfDisabled="{x:Null}" ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" Activate="True" DelayBetweenKeys="5" DisplayName="Type Into - EPR" sap:VirtualizedContainerService.HintSize="333.6,135.2" sap2010:WorkflowViewState.IdRef="TypeInto_1" SimulateType="False" Text="EPR">
                            <ui:TypeInto.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="b84c65e5-ea2f-49fe-9d30-e3ed0f0c6927" InformativeScreenshot="bf49f57f84cd3d9da14fd06d8c047a01" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl aria-role='combobox' tag='INPUT' /&gt;">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                                <ui:Target.WaitForReady>
                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                </ui:Target.WaitForReady>
                              </ui:Target>
                            </ui:TypeInto.Target>
                          </ui:TypeInto>
                          <ui:TypeInto AlterIfDisabled="{x:Null}" ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SimulateType="{x:Null}" Activate="True" DelayBetweenKeys="5" DisplayName="Type Into - Code of Practice" sap:VirtualizedContainerService.HintSize="333.6,135.2" sap2010:WorkflowViewState.IdRef="TypeInto_2" Text="Code of Practice Declarations - Waste">
                            <ui:TypeInto.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d70ec8a9-04a6-423e-9052-60fc69178011" InformativeScreenshot="4f8d5c1f32f79e9b975ed004bfe057b2" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl aria-role='combobox' idx='2' tag='INPUT' /&gt;">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                                <ui:Target.WaitForReady>
                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                </ui:Target.WaitForReady>
                              </ui:Target>
                            </ui:TypeInto.Target>
                          </ui:TypeInto>
                          <ui:TypeInto AlterIfDisabled="{x:Null}" ClickBeforeTyping="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" EmptyField="{x:Null}" SendWindowMessages="{x:Null}" SimulateType="{x:Null}" Activate="True" DelayBetweenKeys="5" DisplayName="Type Into - N/A" sap:VirtualizedContainerService.HintSize="333.6,135.2" sap2010:WorkflowViewState.IdRef="TypeInto_3" Text="N/A">
                            <ui:TypeInto.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="c1590ffd-7408-480e-9842-c8fe31a7fdc9" InformativeScreenshot="5460a4a1fb4696800245dadd47d28bf9" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl aria-role='combobox' idx='3' tag='INPUT' /&gt;">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                                <ui:Target.WaitForReady>
                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                </ui:Target.WaitForReady>
                              </ui:Target>
                            </ui:TypeInto.Target>
                          </ui:TypeInto>
                          <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" SimulateClick="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click Next Field" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="Click_19" KeyModifiers="None" MouseButton="BTN_LEFT">
                            <ui:Click.CursorPosition>
                              <ui:CursorPosition Position="Center">
                                <ui:CursorPosition.OffsetX>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:CursorPosition.OffsetX>
                                <ui:CursorPosition.OffsetY>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:CursorPosition.OffsetY>
                              </ui:CursorPosition>
                            </ui:Click.CursorPosition>
                            <ui:Click.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="d3d619c5-dcfa-44f0-b881-e7bd71849680" InformativeScreenshot="55213ca588c2e07b4cd38aef0aad4238" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl aria-role='combobox' idx='4' tag='INPUT' /&gt;">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                                <ui:Target.WaitForReady>
                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                </ui:Target.WaitForReady>
                              </ui:Target>
                            </ui:Click.Target>
                          </ui:Click>
                        </Sequence>
                      </ui:BlockUserInput.Body>
                    </ui:BlockUserInput>
                    <If Condition="[Cbool(io_Config(&quot;Pausepoint 2&quot;))=True]" DisplayName="If Pausepoint 2 is Enabled:" sap:VirtualizedContainerService.HintSize="487.2,302.4" sap2010:WorkflowViewState.IdRef="If_44">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Pausepoint1 workflow" sap:VirtualizedContainerService.HintSize="336.8,113.6" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_4" UnSafe="False" WorkflowFileName="Process/Process Subflows/Pausepoint1.xaml">
                          <ui:InvokeWorkflowFile.Arguments>
                            <InArgument x:TypeArguments="x:String" x:Key="in_strPopupMessage" xml:space="preserve">&lt;h1&gt;Check DMS Folder Creation Information&lt;/h1&gt;&lt;br&gt;&lt;p&gt;Please check the information input in the create folder screen. If all information is correct, please press continue. If not, please click stop, and provide a desciption of the issue in the form appearing thereafter. </InArgument>
                          </ui:InvokeWorkflowFile.Arguments>
                        </ui:InvokeWorkflowFile>
                      </If.Then>
                    </If>
                    <ui:BlockUserInput TimeoutMS="{x:Null}" BlockType="All" DisplayName="Block User Input" sap:VirtualizedContainerService.HintSize="487.2,796.8" sap2010:WorkflowViewState.IdRef="BlockUserInput_4" KeyModifiers="Alt" SpecialKey="True">
                      <ui:BlockUserInput.Body>
                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="452,669.6" sap2010:WorkflowViewState.IdRef="Sequence_97">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:Click AlterIfDisabled="{x:Null}" DelayBefore="{x:Null}" DelayMS="{x:Null}" SendWindowMessages="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click Create Permit Folder" sap:VirtualizedContainerService.HintSize="410.4,107.2" sap2010:WorkflowViewState.IdRef="Click_18" KeyModifiers="None" MouseButton="BTN_LEFT" SimulateClick="True">
                            <ui:Click.CursorPosition>
                              <ui:CursorPosition Position="Center">
                                <ui:CursorPosition.OffsetX>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:CursorPosition.OffsetX>
                                <ui:CursorPosition.OffsetY>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:CursorPosition.OffsetY>
                              </ui:CursorPosition>
                            </ui:Click.CursorPosition>
                            <ui:Click.Target>
                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="1ec27191-81a4-4eda-bfff-62f99b531d7d" InformativeScreenshot="fd74f235f7153a5e81abedeff18ed413" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl aaname='Create Permit Folder' parentid='5747abb9-f82c-48ed-9ca0-7a9ce583cdad' tag='BUTTON' /&gt;">
                                <ui:Target.TimeoutMS>
                                  <InArgument x:TypeArguments="x:Int32" />
                                </ui:Target.TimeoutMS>
                                <ui:Target.WaitForReady>
                                  <InArgument x:TypeArguments="ui:WaitForReady" />
                                </ui:Target.WaitForReady>
                              </ui:Target>
                            </ui:Click.Target>
                          </ui:Click>
                          <Delay DisplayName="Delay - Wait for element to appear" Duration="00:00:03" sap:VirtualizedContainerService.HintSize="410.4,22.4" sap2010:WorkflowViewState.IdRef="Delay_2" />
                          <ui:InterruptibleDoWhile Condition="[booElementExists=True]" DisplayName="Do While folder is creating:" sap:VirtualizedContainerService.HintSize="410.4,367.2" sap2010:WorkflowViewState.IdRef="InterruptibleDoWhile_4">
                            <ui:InterruptibleDoWhile.Body>
                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="375.2,200" sap2010:WorkflowViewState.IdRef="Sequence_96">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:UiElementExists DisplayName="Element Exists - Creating Permit Folder" Exists="[booElementExists]" sap:VirtualizedContainerService.HintSize="333.6,107.2" sap2010:WorkflowViewState.IdRef="UiElementExists_8">
                                  <ui:UiElementExists.Target>
                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Id="82b69cc4-7645-4e3d-a24b-3805ae62be2e" InformativeScreenshot="56a2f1e519cad4e8f6ff72751b66369f" Selector="&lt;html app='msedge.exe' title='Document Management Service - Permit Request' /&gt;&lt;webctrl id='responseContainer' tag='DIV' aaname='Creating the permit folder...' /&gt;" TimeoutMS="3000">
                                      <ui:Target.WaitForReady>
                                        <InArgument x:TypeArguments="ui:WaitForReady" />
                                      </ui:Target.WaitForReady>
                                    </ui:Target>
                                  </ui:UiElementExists.Target>
                                </ui:UiElementExists>
                              </Sequence>
                            </ui:InterruptibleDoWhile.Body>
                          </ui:InterruptibleDoWhile>
                        </Sequence>
                      </ui:BlockUserInput.Body>
                    </ui:BlockUserInput>
                  </Sequence>
                </ActivityAction>
              </ui:BrowserScope.Body>
            </ui:BrowserScope>
          </Sequence>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID4">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">200,721.7</av:Point>
                  <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">300,790.5 300,840.5</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="Send Email to Area Contact" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_48">
                <Sequence.Variables>
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="listSentEmail" />
                  <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="listDrafts" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:ReportStatus DisplayName="Report Status - Creating/Sending Email" sap:VirtualizedContainerService.HintSize="711.2,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_12" StatusText="[&quot;Creating/Sending Email...&quot;]" />
                <If Condition="[Cbool(io_Config(&quot;Pausepoint 3&quot;))=True]" DisplayName="If Pausepoint 3 is Enabled:" sap:VirtualizedContainerService.HintSize="711.2,772" sap2010:WorkflowViewState.IdRef="If_45">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <Sequence sap:VirtualizedContainerService.HintSize="378.4,583.2" sap2010:WorkflowViewState.IdRef="Sequence_90">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:SendOutlookMail Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Account="[io_Config(&quot;Outlook - Account&quot;).tostring]" AttachmentsCollection="[directory.getfiles(in_StrworkingFolder+&quot;\SavedEmail&quot;)]" Body="[&quot;Hello,&quot;+environment.newline+environment.newline+&quot;Please find details For a CLAIRE declaration relevant To your area. I would be grateful If you could forward this To the relevant EM And GWCL contacts.&quot;+environment.newline+environment.newline+&quot;The details have been added To the CLAIRE declaration spreadsheet which can be found here.&quot;+environment.newline+environment.newline+&quot;O:\BRITE\National-Permitting-Service\Environment Management\Permit Register And Assess\CLAIRE Declarations Spreadsheet&quot;+environment.newline+environment.newline+&quot;The original notification has been saved To DMS under Case reference number &quot;+strPermitNumber+&quot;.&quot;]" DisplayName="Create Draft Email" sap:VirtualizedContainerService.HintSize="336.8,146.4" sap2010:WorkflowViewState.IdRef="SendOutlookMail_1" IsBodyHtml="False" IsDraft="True" Subject="[&quot;FW&quot;+in_TransactionItem.subject.ToString]" To="[strAreaEmail]">
                        <ui:SendOutlookMail.Files>
                          <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                        </ui:SendOutlookMail.Files>
                      </ui:SendOutlookMail>
                      <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Pausepoint1 workflow" sap:VirtualizedContainerService.HintSize="336.8,113.6" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_5" UnSafe="False" WorkflowFileName="Process/Process Subflows/Pausepoint1.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="x:String" x:Key="in_strPopupMessage">&lt;h1&gt;Check Draft Email&lt;/h1&gt;&lt;p&gt;The robot has produced a draft email to the contact area. Please check this email and click continue if no issues are found.&lt;br&gt;&lt;/p&gt;</InArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <ui:GetOutlookMailMessages Filter="{x:Null}" TimeoutMS="{x:Null}" Account="[io_Config(&quot;Outlook - Account&quot;).ToString]" DisplayName="Get Draft Message" GetAttachements="False" sap:VirtualizedContainerService.HintSize="336.8,22.4" sap2010:WorkflowViewState.IdRef="GetOutlookMailMessages_2" MailFolder="Inbox" MarkAsRead="False" Messages="[listDrafts]" OnlyUnreadMessages="False" Top="1" />
                      <ui:MoveOutlookMessage Account="[io_Config(&quot;Outlook - Account&quot;).tostring]" DisplayName="Move Draft to Deleted" sap:VirtualizedContainerService.HintSize="336.8,88" sap2010:WorkflowViewState.IdRef="MoveOutlookMessage_1" MailFolder="Deleted Items" MailMessage="[listDrafts(0)]" />
                    </Sequence>
                  </If.Then>
                </If>
                <If Condition="[io_Config(&quot;Test Mode&quot;).ToString=&quot;False&quot;]" DisplayName="If test mode is on:" sap:VirtualizedContainerService.HintSize="711.2,305.6" sap2010:WorkflowViewState.IdRef="If_40">
                  <If.Then>
                    <ui:SendOutlookMail Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Account="[io_Config(&quot;Outlook - Account&quot;).tostring]" AttachmentsCollection="[directory.getfiles(in_StrworkingFolder+&quot;\SavedEmail&quot;)]" Body="[&quot;Hello,&quot;+environment.newline+environment.newline+&quot;Please find details For a CLAIRE declaration relevant To your area. I would be grateful If you could forward this To the relevant EM And GWCL contacts.&quot;+environment.newline+environment.newline+&quot;The details have been added To the CLAIRE declaration spreadsheet which can be found here.&quot;+environment.newline+environment.newline+&quot;O:\BRITE\National-Permitting-Service\Environment Management\Permit Register And Assess\CLAIRE Declarations Spreadsheet&quot;+environment.newline+environment.newline+&quot;The original notification has been saved To DMS under Case reference number &quot;+strPermitNumber+&quot;.&quot;]" DisplayName="Send Email to Area" sap:VirtualizedContainerService.HintSize="333.6,146.4" sap2010:WorkflowViewState.IdRef="SendOutlookMail_3" IsBodyHtml="False" IsDraft="False" Subject="[&quot;FW&quot;+in_TransactionItem.subject.ToString]" To="[strAreaEmail]">
                      <ui:SendOutlookMail.Files>
                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                      </ui:SendOutlookMail.Files>
                    </ui:SendOutlookMail>
                  </If.Then>
                  <If.Else>
                    <ui:SendOutlookMail Bcc="{x:Null}" Cc="{x:Null}" MailMessage="{x:Null}" TimeoutMS="{x:Null}" Account="[io_Config(&quot;Outlook - Account&quot;).tostring]" AttachmentsCollection="[directory.getfiles(in_StrworkingFolder+&quot;\SavedEmail&quot;)]" Body="[&quot;Hello,&quot;+environment.newline+environment.newline+&quot;Please find details For a CLAIRE declaration relevant To your area. I would be grateful If you could forward this To the relevant EM And GWCL contacts.&quot;+environment.newline+environment.newline+&quot;The details have been added To the CLAIRE declaration spreadsheet which can be found here.&quot;+environment.newline+environment.newline+&quot;O:\BRITE\National-Permitting-Service\Environment Management\Permit Register And Assess\CLAIRE Declarations Spreadsheet&quot;+environment.newline+environment.newline+&quot;The original notification has been saved To DMS under Case reference number &quot;+strPermitNumber+&quot;.&quot;]" DisplayName="Send Email to Kai Lumber" sap:VirtualizedContainerService.HintSize="333.6,146.4" sap2010:WorkflowViewState.IdRef="SendOutlookMail_4" IsBodyHtml="False" IsDraft="False" Subject="[&quot;FW&quot;+in_TransactionItem.subject.ToString]" To="kai.lumber@defra.gov.uk">
                      <ui:SendOutlookMail.Files>
                        <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                      </ui:SendOutlookMail.Files>
                    </ui:SendOutlookMail>
                  </If.Else>
                </If>
                <ui:GetOutlookMailMessages Filter="{x:Null}" TimeoutMS="{x:Null}" Account="[io_Config(&quot;Outlook - Account&quot;).ToString]" DisplayName="Get Sent Message" GetAttachements="False" sap:VirtualizedContainerService.HintSize="711.2,22.4" sap2010:WorkflowViewState.IdRef="GetOutlookMailMessages_1" MailFolder="Sent Items" MarkAsRead="False" Messages="[listSentEmail]" OnlyUnreadMessages="False" Top="1" />
                <ui:SaveMail DisplayName="Save Sent Mail Message" FilePath="[in_strWorkingFolder+&quot;\&quot;+strPermitNumber+&quot; Email to Area &quot;+datetime.now.tostring(&quot;dd.MM.yyyy&quot;)+&quot;.eml&quot;]" sap:VirtualizedContainerService.HintSize="711.2,88" sap2010:WorkflowViewState.IdRef="SaveMail_2" MailMessage="[listSentEmail(0)]" />
              </Sequence>
              <FlowStep.Next>
                <FlowStep x:Name="__ReferenceID5">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <av:Point x:Key="ShapeLocation">200,840.5</av:Point>
                      <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                      <av:PointCollection x:Key="ConnectorLocation">300,909.3 300,959.3</av:PointCollection>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Sequence DisplayName="Upload Emails/Attachments" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_49">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:ReportStatus DisplayName="Report Status - Uploading Emails/Attachments" sap:VirtualizedContainerService.HintSize="1167.2,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_13" StatusText="[&quot;Uploading emails and attachments...&quot;]" />
                    <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1167.2,1199.2" sap2010:WorkflowViewState.IdRef="ForEach`1_3" Values="[directory.getfiles(in_strWorkingFolder+&quot;\SavedEmail&quot;)]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="x:Object">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="x:Object" Name="file" />
                          </ActivityAction.Argument>
                          <If Condition="[file.tostring.contains(&quot;.eml&quot;)]" DisplayName="If file contains .eml " sap:VirtualizedContainerService.HintSize="1132,1074.4" sap2010:WorkflowViewState.IdRef="If_41">
                            <If.Then>
                              <usa:SharepointApplicationScope AzureApplicationID="{x:Null}" ClientContext="{x:Null}" ClientId="{x:Null}" ClientSecret="{x:Null}" LoginTimeout="{x:Null}" Password="{x:Null}" AzureAppPermissions="None" DisplayName="Sharepoint application scope - Upload CL:AIRE Email" sap:VirtualizedContainerService.HintSize="505.6,633.6" sap2010:WorkflowViewState.IdRef="SharepointApplicationScope_2" PlatformType="Online" QueryGrouping="False" ResetCredentials="False" SecurePassword="[in_CredDMS.SecurePassword]" SharePointInstanceType="Online" URL="[io_Config(&quot;DMS - URL&quot;).ToString]" UserName="[in_CredDMS.UserName.tostring]">
                                <usa:SharepointApplicationScope.Body>
                                  <ActivityAction x:TypeArguments="us:SharePointContextInfo">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="us:SharePointContextInfo" Name="SharePointContextInfoTag" />
                                    </ActivityAction.Argument>
                                    <Sequence sap:VirtualizedContainerService.HintSize="472,492" sap2010:WorkflowViewState.IdRef="Sequence_78">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="dictProperties" />
                                        <Variable x:TypeArguments="x:String" Name="strUploadName" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:MultipleAssign DisplayName="Assign Properties Dictionary - Email from CL:AIRE" sap:VirtualizedContainerService.HintSize="430.4,256.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_27">
                                        <ui:MultipleAssign.AssignOperations>
                                          <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_174">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[dictProperties]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[New Dictionary(Of String, Object)]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_175">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dictProperties("ExternalAuthor")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[io_Config("DMS - External Author").ToString]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_176">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dictProperties("EAReceivedDate")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_177">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dictProperties("DocumentDate")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_178">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:Object">[dictProperties("c52c737aaa794145b5e1ab0b33580095")]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:Object">["Public Register|f1fcf6a6-5d97-4f1d-964e-a2f916eb1f18"]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                            <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_179">
                                              <ui:AssignOperation.To>
                                                <OutArgument x:TypeArguments="x:String">[strUploadName]</OutArgument>
                                              </ui:AssignOperation.To>
                                              <ui:AssignOperation.Value>
                                                <InArgument x:TypeArguments="x:String">[strPermitNumber+" Qualified Person Declaration "+in_TransactionItem.DateAsDateTime.ToString("dd.MM.yyyy")]</InArgument>
                                              </ui:AssignOperation.Value>
                                            </ui:AssignOperation>
                                          </scg:List>
                                        </ui:MultipleAssign.AssignOperations>
                                      </ui:MultipleAssign>
                                      <usal:UploadFile AttachmentsAction="{x:Null}" RelativeUrlHintText="{x:Null}" AllowOperationsOnASPXFiles="False" AllowOverwrite="True" CheckInFileAfterCreation="True" CheckOutFileBeforeOverwrite="False" ChooseFile="True" DisplayName="Upload file to DMS - CL:AIRE Email" sap:VirtualizedContainerService.HintSize="430.4,102.4" sap2010:WorkflowViewState.IdRef="UploadFile_3" LocalPath="[file.tostring]" LocalPathHintText="The current local path of the file" PropertiesToAdd="[dictProperties]" RelativeUrl="[&quot;LIB2/&quot;+strPermitNumber+&quot;/Application%20%EF%BC%86%20Associated%20Docs/&quot;+(strUploadName.Replace(&quot; &quot;,&quot;%20&quot;))+&quot;.eml&quot;]" ShowAttachFiles="False" ShowCAMLQuery="False" ShowCAMLWarning="False" ShowGroupDescription="False" ShowGroupName="False" ShowLibraryName="False" ShowListName="False" ShowLocalPath="True" ShowMove="False" ShowPermissionDropdown="False" ShowPropertiesDictionary="False" ShowRelativeUrl="True" ShowRename="False" ShowUserName="False" />
                                    </Sequence>
                                  </ActivityAction>
                                </usa:SharepointApplicationScope.Body>
                              </usa:SharepointApplicationScope>
                            </If.Then>
                            <If.Else>
                              <Sequence sap:VirtualizedContainerService.HintSize="582.4,915.2" sap2010:WorkflowViewState.IdRef="Sequence_102">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[file.tostring.contains(&quot;.pdf&quot;)]" DisplayName="If file contains .pdf" sap:VirtualizedContainerService.HintSize="540.8,822.4" sap2010:WorkflowViewState.IdRef="If_48">
                                  <If.Then>
                                    <usa:SharepointApplicationScope AzureApplicationID="{x:Null}" ClientContext="{x:Null}" ClientId="{x:Null}" ClientSecret="{x:Null}" LoginTimeout="{x:Null}" Password="{x:Null}" AzureAppPermissions="None" DisplayName="Sharepoint application scope - Upload Attachments" sap:VirtualizedContainerService.HintSize="505.6,633.6" sap2010:WorkflowViewState.IdRef="SharepointApplicationScope_5" PlatformType="Online" QueryGrouping="False" ResetCredentials="False" SecurePassword="[in_CredDMS.SecurePassword]" SharePointInstanceType="Online" URL="[io_Config(&quot;DMS - URL&quot;).ToString]" UserName="[in_CredDMS.UserName]">
                                      <usa:SharepointApplicationScope.Body>
                                        <ActivityAction x:TypeArguments="us:SharePointContextInfo">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="us:SharePointContextInfo" Name="SharePointContextInfoTag" />
                                          </ActivityAction.Argument>
                                          <Sequence sap:VirtualizedContainerService.HintSize="472,492" sap2010:WorkflowViewState.IdRef="Sequence_84">
                                            <Sequence.Variables>
                                              <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="dictProperties" />
                                              <Variable x:TypeArguments="x:String" Name="strUploadName" />
                                            </Sequence.Variables>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:MultipleAssign DisplayName="Assign Properties Dictionary - Attachment" sap:VirtualizedContainerService.HintSize="430.4,256.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_30">
                                              <ui:MultipleAssign.AssignOperations>
                                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_192">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[dictProperties]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[New Dictionary(Of String, Object)]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_193">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("ExternalAuthor")]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Object">[io_Config("DMS - External Author").ToString]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_194">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("EAReceivedDate")]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Object">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_195">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("DocumentDate")]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Object">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_196">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("c52c737aaa794145b5e1ab0b33580095")]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:Object">["Public Register|f1fcf6a6-5d97-4f1d-964e-a2f916eb1f18"]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_197">
                                                    <ui:AssignOperation.To>
                                                      <OutArgument x:TypeArguments="x:String">[strUploadName]</OutArgument>
                                                    </ui:AssignOperation.To>
                                                    <ui:AssignOperation.Value>
                                                      <InArgument x:TypeArguments="x:String">[file.ToString.split("\"c).Last+" "+in_TransactionItem.DateAsDateTime.ToString("dd.MM.yyyy")]</InArgument>
                                                    </ui:AssignOperation.Value>
                                                  </ui:AssignOperation>
                                                </scg:List>
                                              </ui:MultipleAssign.AssignOperations>
                                            </ui:MultipleAssign>
                                            <usal:UploadFile AttachmentsAction="{x:Null}" RelativeUrlHintText="{x:Null}" AllowOperationsOnASPXFiles="False" AllowOverwrite="True" CheckInFileAfterCreation="True" CheckOutFileBeforeOverwrite="False" ChooseFile="True" DisplayName="Upload file to DMS - Attachment" sap:VirtualizedContainerService.HintSize="430.4,102.4" sap2010:WorkflowViewState.IdRef="UploadFile_6" LocalPath="[file.tostring]" LocalPathHintText="The current local path of the file" PropertiesToAdd="[dictProperties]" RelativeUrl="[&quot;LIB2/&quot;+strPermitNumber+&quot;/Application%20%EF%BC%86%20Associated%20Docs/&quot;+(strUploadName.Replace(&quot; &quot;,&quot;%20&quot;))+&quot;.pdf&quot;]" ShowAttachFiles="False" ShowCAMLQuery="False" ShowCAMLWarning="False" ShowGroupDescription="False" ShowGroupName="False" ShowLibraryName="False" ShowListName="False" ShowLocalPath="True" ShowMove="False" ShowPermissionDropdown="False" ShowPropertiesDictionary="False" ShowRelativeUrl="True" ShowRename="False" ShowUserName="False" />
                                          </Sequence>
                                        </ActivityAction>
                                      </usa:SharepointApplicationScope.Body>
                                    </usa:SharepointApplicationScope>
                                  </If.Then>
                                  <If.Else>
                                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_101">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </Sequence>
                                  </If.Else>
                                </If>
                              </Sequence>
                            </If.Else>
                          </If>
                        </ActivityAction>
                      </ui:ForEach.Body>
                    </ui:ForEach>
                    <usa:SharepointApplicationScope AzureApplicationID="{x:Null}" ClientContext="{x:Null}" ClientId="{x:Null}" ClientSecret="{x:Null}" LoginTimeout="{x:Null}" Password="{x:Null}" AzureAppPermissions="None" DisplayName="Sharepoint application scope - Upload Sent Email" sap:VirtualizedContainerService.HintSize="1167.2,754.4" sap2010:WorkflowViewState.IdRef="SharepointApplicationScope_3" PlatformType="Online" QueryGrouping="False" ResetCredentials="False" SecurePassword="[in_CredDMS.SecurePassword]" SharePointInstanceType="Online" URL="[io_Config(&quot;DMS - URL&quot;).ToString]" UserName="[in_CredDMS.UserName]">
                      <usa:SharepointApplicationScope.Body>
                        <ActivityAction x:TypeArguments="us:SharePointContextInfo">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="us:SharePointContextInfo" Name="SharePointContextInfoTag" />
                          </ActivityAction.Argument>
                          <Sequence sap:VirtualizedContainerService.HintSize="472,612.8" sap2010:WorkflowViewState.IdRef="Sequence_79">
                            <Sequence.Variables>
                              <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="dictProperties" />
                              <Variable x:TypeArguments="x:String" Name="strUploadName" />
                            </Sequence.Variables>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:MultipleAssign DisplayName="Assign Properties Dictionary - Email to Area" sap:VirtualizedContainerService.HintSize="430.4,256.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_28">
                              <ui:MultipleAssign.AssignOperations>
                                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_180">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[dictProperties]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)">[New Dictionary(Of String, Object)]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_181">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("ExternalAuthor")]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:Object">[io_Config("DMS - External Author").ToString]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_182">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("EAReceivedDate")]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:Object">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_183">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("DocumentDate")]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:Object">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_184">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:Object">[dictProperties("c52c737aaa794145b5e1ab0b33580095")]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:Object">["Internal Only|8ea715af-5874-4d14-8309-f46c5fa3b3b6"]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_185">
                                    <ui:AssignOperation.To>
                                      <OutArgument x:TypeArguments="x:String">[strUploadName]</OutArgument>
                                    </ui:AssignOperation.To>
                                    <ui:AssignOperation.Value>
                                      <InArgument x:TypeArguments="x:String">[strPermitNumber+" Email to Area "+in_TransactionItem.DateAsDateTime.ToString("dd.MM.yyyy")]</InArgument>
                                    </ui:AssignOperation.Value>
                                  </ui:AssignOperation>
                                </scg:List>
                              </ui:MultipleAssign.AssignOperations>
                            </ui:MultipleAssign>
                            <usal:UploadFile AttachmentsAction="{x:Null}" RelativeUrlHintText="{x:Null}" AllowOperationsOnASPXFiles="False" AllowOverwrite="True" CheckInFileAfterCreation="True" CheckOutFileBeforeOverwrite="False" ChooseFile="True" DisplayName="Upload file to DMS - Sent Email" sap:VirtualizedContainerService.HintSize="430.4,102.4" sap2010:WorkflowViewState.IdRef="UploadFile_4" LocalPath="[in_strWorkingFolder+&quot;\&quot;+strPermitNumber+&quot; Email to Area &quot;+datetime.now.tostring(&quot;dd.MM.yyyy&quot;)+&quot;.eml&quot;]" LocalPathHintText="The current local path of the file" PropertiesToAdd="[dictProperties]" RelativeUrl="[&quot;LIB2/&quot;+strPermitNumber+&quot;/General%20Correspondence/&quot;+(strUploadName.Replace(&quot; &quot;,&quot;%20&quot;))+&quot;.eml&quot;]" ShowAttachFiles="False" ShowCAMLQuery="False" ShowCAMLWarning="False" ShowGroupDescription="False" ShowGroupName="False" ShowLibraryName="False" ShowListName="False" ShowLocalPath="True" ShowMove="False" ShowPermissionDropdown="False" ShowPropertiesDictionary="False" ShowRelativeUrl="True" ShowRename="False" ShowUserName="False" />
                            <ui:DeleteFileX DisplayName="Delete File - Local Sent Email" sap:VirtualizedContainerService.HintSize="430.4,80.8" sap2010:WorkflowViewState.IdRef="DeleteFileX_2" Path="[in_strWorkingFolder+&quot;\&quot;+strPermitNumber+&quot; Email to Area &quot;+datetime.now.tostring(&quot;dd.MM.yyyy&quot;)+&quot; .eml&quot;]" />
                          </Sequence>
                        </ActivityAction>
                      </usa:SharepointApplicationScope.Body>
                    </usa:SharepointApplicationScope>
                    <If Condition="[Cbool(io_Config(&quot;Pausepoint 4&quot;))=True]" DisplayName="If Pausepoint 4 is Enabled:" sap:VirtualizedContainerService.HintSize="1167.2,497.6" sap2010:WorkflowViewState.IdRef="If_46">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <Sequence sap:VirtualizedContainerService.HintSize="508,308.8" sap2010:WorkflowViewState.IdRef="Sequence_91">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:OpenBrowser AutomaticallyDownloadWebDriver="{x:Null}" CommunicationMethod="{x:Null}" Hidden="{x:Null}" NewSession="{x:Null}" Private="{x:Null}" UiBrowser="{x:Null}" BrowserType="Edge" DisplayName="Open Browser - Current DMS Folder" sap:VirtualizedContainerService.HintSize="466.4,216" sap2010:WorkflowViewState.IdRef="OpenBrowser_4" Url="[&quot;https://defradev.sharepoint.com/sites/EADMSTestb52/LIB2/&quot;+strPermitNumber]">
                            <ui:OpenBrowser.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Pausepoint1 workflow" sap:VirtualizedContainerService.HintSize="336,113.6" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_6" UnSafe="False" WorkflowFileName="Process/Process Subflows/Pausepoint1.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_strPopupMessage" xml:space="preserve">&lt;h1&gt;Check Sharepoint Uploads&lt;/h1&gt;&lt;p&gt;The robot has completed uploading the following items to sharepoint. Please check these have been uploaded sucessfully, and that all metadata has been sucessfully completed.&lt;br&gt;&lt;br&gt;- Incoming CL:AIRE Email&lt;br&gt;- Attachments of the above email&lt;br&gt;- Email to contact area&lt;br&gt;&lt;br&gt;If all files are correctly uploaded, please click continue. </InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                              </ActivityAction>
                            </ui:OpenBrowser.Body>
                          </ui:OpenBrowser>
                        </Sequence>
                      </If.Then>
                    </If>
                  </Sequence>
                  <FlowStep.Next>
                    <FlowStep x:Name="__ReferenceID7">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <av:Point x:Key="ShapeLocation">200,959.3</av:Point>
                          <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                          <av:PointCollection x:Key="ConnectorLocation">300,1028.1 300,1078.1</av:PointCollection>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Sequence DisplayName="Update Master Sheet" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_51">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ReportStatus DisplayName="Report Status - Updating master sheet" sap:VirtualizedContainerService.HintSize="433.6,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_14" StatusText="[&quot;Updating master sheet...&quot;]" />
                        <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="Excel Application Scope - Master Sheet" sap:VirtualizedContainerService.HintSize="433.6,290.4" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_2" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[in_strWorkingFolder+&quot;\&quot;+(io_Config(&quot;File Path - Master Sheet&quot;).ToString.Split(&quot;\&quot;c).Last)]">
                          <ui:ExcelApplicationScope.Body>
                            <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="375.2,180.8" sap2010:WorkflowViewState.IdRef="Sequence_86">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:ExcelWriteRange AddHeaders="False" DataTable="[datLineToAdd]" DisplayName="Write Range - Master Sheet" sap:VirtualizedContainerService.HintSize="333.6,88" sap2010:WorkflowViewState.IdRef="ExcelWriteRange_1" SheetName="Sheet1" StartingCell="[&quot;A&quot;+intRowNo.ToString]" />
                              </Sequence>
                            </ActivityAction>
                          </ui:ExcelApplicationScope.Body>
                        </ui:ExcelApplicationScope>
                      </Sequence>
                      <FlowStep.Next>
                        <FlowStep x:Name="__ReferenceID8">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <av:Point x:Key="ShapeLocation">200,1078.1</av:Point>
                              <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                              <av:PointCollection x:Key="ConnectorLocation">300,1146.9 300,1196.9</av:PointCollection>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Sequence DisplayName="Update O Drive Master Sheet" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_52">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ui:ReportStatus DisplayName="Report Status - Updating O drive sheet" sap:VirtualizedContainerService.HintSize="510.4,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_15" StatusText="[&quot;Updating area sheet...&quot;]" />
                            <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="510.4,461.6" sap2010:WorkflowViewState.IdRef="CommentOut_6">
                              <ui:CommentOut.Body>
                                <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="475.2,383.2" sap2010:WorkflowViewState.IdRef="Sequence_109">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="Excel Application Scope - O Drive Sheet" sap:VirtualizedContainerService.HintSize="433.6,290.4" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_3" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[in_strWorkingFolder+&quot;\&quot;+(io_Config(&quot;File Path - Area Sheet&quot;).ToString.Split(&quot;\&quot;c).Last)]">
                                    <ui:ExcelApplicationScope.Body>
                                      <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                        </ActivityAction.Argument>
                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="375.2,180.8" sap2010:WorkflowViewState.IdRef="Sequence_87">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:ExcelAppendRange DataTable="[datLineToAdd]" DisplayName="Append Range - O Drive Sheet" sap:VirtualizedContainerService.HintSize="333.6,88" sap2010:WorkflowViewState.IdRef="ExcelAppendRange_1" SheetName="Sheet1" />
                                        </Sequence>
                                      </ActivityAction>
                                    </ui:ExcelApplicationScope.Body>
                                  </ui:ExcelApplicationScope>
                                </Sequence>
                              </ui:CommentOut.Body>
                            </ui:CommentOut>
                          </Sequence>
                          <FlowStep.Next>
                            <FlowStep x:Name="__ReferenceID6">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <av:Point x:Key="ShapeLocation">200,1196.9</av:Point>
                                  <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                                  <av:PointCollection x:Key="ConnectorLocation">300,1265.7 300,1315.7</av:PointCollection>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Sequence DisplayName="Update Working Days Spreadsheet" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_50">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="sd1:DataTable" Name="datWorkingDays" />
                                  <Variable x:TypeArguments="x:String" Name="strDate1" />
                                  <Variable x:TypeArguments="x:String" Name="strPart1" />
                                  <Variable x:TypeArguments="x:String" Name="strPart2" />
                                  <Variable x:TypeArguments="x:String" Name="strPart3" />
                                  <Variable x:TypeArguments="x:String" Name="strDateDifference" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:ReportStatus DisplayName="Report Status - Updating working days" sap:VirtualizedContainerService.HintSize="510.4,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_16" StatusText="[&quot;Updating working days sheet...&quot;]" />
                                <ui:BuildDataTable DataTable="[datWorkingDays]" DisplayName="Build Data Table - Working Days" sap:VirtualizedContainerService.HintSize="510.4,60" sap2010:WorkflowViewState.IdRef="BuildDataTable_4" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Date_x0020_Recieved&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Your_x0020_Name&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Date_x0020_Sent_x0020_to_x0020_Area&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Age&quot; msdata:Caption=&quot;&quot; type=&quot;xs:string&quot; minOccurs=&quot;0&quot; /&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                                <ui:MultipleAssign DisplayName="Multiple Assign - Convert to American Format" sap:VirtualizedContainerService.HintSize="510.4,256.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_31">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_198">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[strDate1]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">[in_TransactionItem.DateAsDateTime.ToString("dd/MM/yyyy")]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_199">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[strPart1]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">[strDate1.split("/"c)(0)]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_200">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[strPart2]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">[strDate1.split("/"c)(1)]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_201">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[strPart3]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">[strDate1.split("/"c)(2)]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_202">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[strDate1]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">[strPart2+"/"+strPart1+"/"+strPart3]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_203">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[strDateDifference]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">[(datetime.Now-CDate(strDate1)).ToString.Split("."c)(0)]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                </ui:MultipleAssign>
                                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{in_TransactionItem.DateAsDateTime.ToString(&quot;dd/MM/yyyy&quot;),io_Config(&quot;DMS - External Author&quot;).ToString,datetime.now.tostring(&quot;dd/MM/yyyy&quot;),strDateDifference}]" DataTable="[datWorkingDays]" DisplayName="Add Data Row - Working Days" sap:VirtualizedContainerService.HintSize="510.4,188" sap2010:WorkflowViewState.IdRef="AddDataRow_3" />
                                <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="510.4,461.6" sap2010:WorkflowViewState.IdRef="CommentOut_7">
                                  <ui:CommentOut.Body>
                                    <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="475.2,383.2" sap2010:WorkflowViewState.IdRef="Sequence_110">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:ExcelApplicationScope Password="{x:Null}" DisplayName="Excel Application Scope - Working Days Sheet" sap:VirtualizedContainerService.HintSize="433.6,290.4" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_4" InstanceCachePeriod="3000" Visible="False" WorkbookPath="[in_strWorkingFolder+&quot;\&quot;+(io_Config(&quot;File Path - Area Sheet&quot;).ToString.Split(&quot;\&quot;c).Last)]">
                                        <ui:ExcelApplicationScope.Body>
                                          <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="375.2,180.8" sap2010:WorkflowViewState.IdRef="Sequence_88">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ExcelAppendRange DataTable="[datWorkingDays]" DisplayName="Append Range - Working Days" sap:VirtualizedContainerService.HintSize="333.6,88" sap2010:WorkflowViewState.IdRef="ExcelAppendRange_2" SheetName="Sheet1" />
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:ExcelApplicationScope.Body>
                                      </ui:ExcelApplicationScope>
                                    </Sequence>
                                  </ui:CommentOut.Body>
                                </ui:CommentOut>
                              </Sequence>
                              <FlowStep.Next>
                                <FlowStep x:Name="__ReferenceID9">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <av:Point x:Key="ShapeLocation">200,1315.7</av:Point>
                                      <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Sequence DisplayName="Update Assets" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_70">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If Condition="[Cbool(io_Config(&quot;Pausepoint 5&quot;))=True]" DisplayName="If Pausepoint 5 is Enabled:" sap:VirtualizedContainerService.HintSize="483.2,395.2" sap2010:WorkflowViewState.IdRef="If_47">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence sap:VirtualizedContainerService.HintSize="380.8,206.4" sap2010:WorkflowViewState.IdRef="Sequence_92">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Pausepoint1 workflow" sap:VirtualizedContainerService.HintSize="339.2,113.6" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_7" UnSafe="False" WorkflowFileName="Process\Process Subflows\Pausepoint 5.xaml">
                                            <ui:InvokeWorkflowFile.Arguments>
                                              <InArgument x:TypeArguments="x:String" x:Key="in_strPopupMessage">["&lt;h1&gt;Check Spreadsheet Updates&lt;/h1&gt;&lt;p&gt;The robot has completed uploading the following spreadsheets located at "+in_strWorkingFolder+". Please check these have been updated correctly.&lt;br&gt;&lt;br&gt;- CLAIRE Declarations Spreadsheet (J Drive)&lt;br&gt;- CLAIRE Declarations Spreadsheet (O Drive)&lt;br&gt;- Working Days Spreadsheet&lt;br&gt;&lt;br&gt;If all files are correctly uploaded, please click continue. "]</InArgument>
                                            </ui:InvokeWorkflowFile.Arguments>
                                          </ui:InvokeWorkflowFile>
                                        </Sequence>
                                      </If.Then>
                                    </If>
                                    <ui:MultipleAssign DisplayName="Multiple Assign - Update Row No and Permit No" sap:VirtualizedContainerService.HintSize="483.2,132" sap2010:WorkflowViewState.IdRef="MultipleAssign_32">
                                      <ui:MultipleAssign.AssignOperations>
                                        <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_204">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:Int32">[intRowNo]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:Int32">[intRowNo+1]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                          <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_205">
                                            <ui:AssignOperation.To>
                                              <OutArgument x:TypeArguments="x:Int32">[intNextPermit]</OutArgument>
                                            </ui:AssignOperation.To>
                                            <ui:AssignOperation.Value>
                                              <InArgument x:TypeArguments="x:Int32">[intNextPermit+1]</InArgument>
                                            </ui:AssignOperation.Value>
                                          </ui:AssignOperation>
                                        </scg:List>
                                      </ui:MultipleAssign.AssignOperations>
                                    </ui:MultipleAssign>
                                    <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Row" DisplayName="Get Asset - Next Row" FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="483.2,139.2" sap2010:WorkflowViewState.IdRef="GetRobotAsset_6">
                                      <ui:GetRobotAsset.Value>
                                        <OutArgument x:TypeArguments="x:Int32">[intRowNo]</OutArgument>
                                      </ui:GetRobotAsset.Value>
                                    </ui:GetRobotAsset>
                                    <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Permit No" DisplayName="Get Asset - Next Permit No." FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="483.2,139.2" sap2010:WorkflowViewState.IdRef="GetRobotAsset_7">
                                      <ui:GetRobotAsset.Value>
                                        <OutArgument x:TypeArguments="x:Int32">[intNextPermit]</OutArgument>
                                      </ui:GetRobotAsset.Value>
                                    </ui:GetRobotAsset>
                                  </Sequence>
                                </FlowStep>
                              </FlowStep.Next>
                            </FlowStep>
                          </FlowStep.Next>
                        </FlowStep>
                      </FlowStep.Next>
                    </FlowStep>
                  </FlowStep.Next>
                </FlowStep>
              </FlowStep.Next>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID0</x:Reference>
    <FlowStep x:Name="__ReferenceID10">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">200,127.7</av:Point>
          <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">300,196.5 300,246.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Sequence DisplayName="Check Next Line in Master Spreadsheet" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_15">
        <Sequence.Variables>
          <Variable x:TypeArguments="x:String" Name="strRowContent" />
          <Variable x:TypeArguments="x:String" Name="strLastRef" />
          <Variable x:TypeArguments="sc:IEnumerable" Name="ieLastRef" />
          <Variable x:TypeArguments="x:String" Name="intLastRef" />
        </Sequence.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <If Condition="[in_TransactionNumber=1]" DisplayName="If Transaction Number is 1:" sap:VirtualizedContainerService.HintSize="1117.6,3064.8" sap2010:WorkflowViewState.IdRef="If_31">
          <If.Then>
            <Sequence DisplayName="First Transaction" sap:VirtualizedContainerService.HintSize="698.4,2905.6" sap2010:WorkflowViewState.IdRef="Sequence_58">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:ReportStatus DisplayName="Report Status - Copying Spreadsheets" sap:VirtualizedContainerService.HintSize="656.8,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_9" StatusText="[&quot;Copying Spreadsheets from Shared Drive...&quot;]" />
              <ui:CopyFile ContinueOnError="{x:Null}" Destination="[in_strWorkingFolder]" DisplayName="Copy master spreadsheet from J drive" sap:VirtualizedContainerService.HintSize="656.8,160" sap2010:WorkflowViewState.IdRef="CopyFile_1" Overwrite="True" Path="[io_Config(&quot;File Path - Master Sheet&quot;).ToString]" />
              <ui:CopyFile ContinueOnError="{x:Null}" Destination="[in_strWorkingFolder]" DisplayName="Copy working days spreadsheet from J Drive" sap:VirtualizedContainerService.HintSize="656.8,160" sap2010:WorkflowViewState.IdRef="CopyFile_2" Overwrite="True" Path="[io_Config(&quot;File Path - Working Days&quot;).ToString]" />
              <ui:CopyFile ContinueOnError="{x:Null}" Destination="[in_strWorkingFolder]" DisplayName="Copy additional sheet from O Drive" sap:VirtualizedContainerService.HintSize="656.8,160" sap2010:WorkflowViewState.IdRef="CopyFile_3" Overwrite="True" Path="[io_Config(&quot;File Path - Area Sheet&quot;).ToString]" />
              <ui:ReportStatus DisplayName="Report Status - Opening Master Sheet" sap:VirtualizedContainerService.HintSize="656.8,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_8" StatusText="[&quot;Opening &amp; Reading Master Sheet...&quot;]" />
              <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Row" DisplayName="Get Asset - Next Row" FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="656.8,139.2" sap2010:WorkflowViewState.IdRef="GetRobotAsset_4">
                <ui:GetRobotAsset.Value>
                  <OutArgument x:TypeArguments="x:Int32">[intRowNo]</OutArgument>
                </ui:GetRobotAsset.Value>
              </ui:GetRobotAsset>
              <ui:ExcelApplicationScope InstanceCachePeriod="{x:Null}" Password="{x:Null}" AutoSave="False" CreateNewFile="False" DisplayName="Excel Application Scope - Master Sheet" sap:VirtualizedContainerService.HintSize="656.8,1819.2" sap2010:WorkflowViewState.IdRef="ExcelApplicationScope_1" ReadOnly="True" Visible="False" WorkbookPath="[in_strWorkingFolder+&quot;\&quot;+(io_Config(&quot;File Path - Master Sheet&quot;).ToString.Split(&quot;\&quot;c).Last)]">
                <ui:ExcelApplicationScope.Body>
                  <ActivityAction x:TypeArguments="ui:WorkbookApplication">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="ui:WorkbookApplication" Name="ExcelWorkbookScope" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="623.2,1709.6" sap2010:WorkflowViewState.IdRef="Sequence_16">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="sd1:DataTable" Name="datNextRow" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:ReportStatus DisplayName="Report Status - Reading Data" sap:VirtualizedContainerService.HintSize="581.6,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_2" StatusText="[&quot;Reading Data...&quot;]" />
                      <ui:ExcelReadRange AddHeaders="False" DataTable="[datNextRow]" DisplayName="Read Range - Column B - Last recorded row + 100" sap:VirtualizedContainerService.HintSize="581.6,60" sap2010:WorkflowViewState.IdRef="ExcelReadRange_1" Range="[&quot;B&quot;+intRowNo.tostring+&quot;:B&quot;+(intRowNo+100).tostring]" SheetName="Sheet1" UseFilter="True" />
                      <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[datNextRow]" DisplayName="For Each Row in extraced data" sap:VirtualizedContainerService.HintSize="581.6,860.8" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
                        <ui:ForEachRow.Body>
                          <ActivityAction x:TypeArguments="sd1:DataRow">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="sd1:DataRow" Name="row" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="548,740" sap2010:WorkflowViewState.IdRef="Sequence_17">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:ExcelReadCell Cell="[&quot;A&quot;+(intRowNo-1).tostring]" DisplayName="Read Cell - Last reference in Column A" sap:VirtualizedContainerService.HintSize="506.4,60" sap2010:WorkflowViewState.IdRef="ExcelReadCell_2" SheetName="Sheet1">
                                <ui:ExcelReadCell.Result>
                                  <OutArgument x:TypeArguments="x:String">[strLastRef]</OutArgument>
                                </ui:ExcelReadCell.Result>
                              </ui:ExcelReadCell>
                              <Assign DisplayName="Get Number Only" sap:VirtualizedContainerService.HintSize="506.4,60" sap2010:WorkflowViewState.IdRef="Assign_29">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieLastRef]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="str:MatchCollection">[system.text.RegularExpressions.regex.Matches(strLastRef,"[0-9]{1,100}")]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:GetRowItem Column="{x:Null}" ColumnName="{x:Null}" ColumnIndex="0" DisplayName="Get Row Item - Current Row" sap:VirtualizedContainerService.HintSize="506.4,188" sap2010:WorkflowViewState.IdRef="GetRowItem_1" Row="[row]">
                                <ui:GetRowItem.Value>
                                  <OutArgument x:TypeArguments="x:String">[strRowContent]</OutArgument>
                                </ui:GetRowItem.Value>
                              </ui:GetRowItem>
                              <If Condition="[strRowContent=&quot;&quot;]" DisplayName="If row item is blank" sap:VirtualizedContainerService.HintSize="506.4,219.2" sap2010:WorkflowViewState.IdRef="If_3">
                                <If.Then>
                                  <ui:Break sap:VirtualizedContainerService.HintSize="200,22.4" sap2010:WorkflowViewState.IdRef="Break_1" />
                                </If.Then>
                                <If.Else>
                                  <Assign DisplayName="Add 1 to next row" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_14">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">[intRowNo]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">[intRowNo+1]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Else>
                              </If>
                            </Sequence>
                          </ActivityAction>
                        </ui:ForEachRow.Body>
                      </ui:ForEachRow>
                      <Assign DisplayName="Convert Numbers to String" sap:VirtualizedContainerService.HintSize="581.6,60" sap2010:WorkflowViewState.IdRef="Assign_28">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strLastRef]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[ieLastRef(0).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign DisplayName="Assign Next Reference" sap:VirtualizedContainerService.HintSize="581.6,60" sap2010:WorkflowViewState.IdRef="Assign_27">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strPermitNumber]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["DCL"+(Cint(strLastRef)+1).tostring]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:SetAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Permit No" DisplayName="Set Asset - Next Permit No." FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="581.6,134.4" sap2010:WorkflowViewState.IdRef="SetAsset_3" Value="[CInt(strLastRef)]" />
                      <ui:SetAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Row" DisplayName="Set Asset - Next Row" FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="581.6,134.4" sap2010:WorkflowViewState.IdRef="SetAsset_1" Value="[intRowNo]" />
                    </Sequence>
                  </ActivityAction>
                </ui:ExcelApplicationScope.Body>
              </ui:ExcelApplicationScope>
            </Sequence>
          </If.Then>
          <If.Else>
            <Sequence sap:VirtualizedContainerService.HintSize="375.2,511.2" sap2010:WorkflowViewState.IdRef="Sequence_59">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Row" DisplayName="Get Asset - Next Row" FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="333.6,139.2" sap2010:WorkflowViewState.IdRef="GetRobotAsset_3">
                <ui:GetRobotAsset.Value>
                  <OutArgument x:TypeArguments="x:Int32">[intRowNo]</OutArgument>
                </ui:GetRobotAsset.Value>
              </ui:GetRobotAsset>
              <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="Excel - Next Permit No" DisplayName="Get Asset - Next Permit No." FolderPath="EA Root/Waste Origins" sap:VirtualizedContainerService.HintSize="333.6,139.2" sap2010:WorkflowViewState.IdRef="GetRobotAsset_5">
                <ui:GetRobotAsset.Value>
                  <OutArgument x:TypeArguments="x:Int32">[intNextPermit]</OutArgument>
                </ui:GetRobotAsset.Value>
              </ui:GetRobotAsset>
              <Assign DisplayName="Assign Next Reference" sap:VirtualizedContainerService.HintSize="333.6,60" sap2010:WorkflowViewState.IdRef="Assign_52">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:String">[strPermitNumber]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:String">["DCL"+(intNextPermit).tostring]</InArgument>
                </Assign.Value>
              </Assign>
            </Sequence>
          </If.Else>
        </If>
      </Sequence>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID2">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">200,246.5</av:Point>
              <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">300,315.3 300,365.3</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="Extract Email Information" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_29">
            <Sequence.Variables>
              <Variable x:TypeArguments="scg:List(snm:MailMessage)" Name="listMessages" />
              <Variable x:TypeArguments="x:String" Name="strEmailBody" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieQPNumber" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieSiteofOrigin" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieDirectTransfer" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieClusterProject" />
              <Variable x:TypeArguments="x:String" Name="strSiteofOriginChecked" />
              <Variable x:TypeArguments="x:String" Name="strDirectTransferChecked" />
              <Variable x:TypeArguments="x:String" Name="strClusterProjectChecked" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieQPName" />
              <Variable x:TypeArguments="x:String" Name="strSiteType" />
              <Variable x:TypeArguments="x:String" Name="strRouteA" />
              <Variable x:TypeArguments="x:String" Name="strRouteB" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieSiteofOriginAddress" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieCustomerOperatorName" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieFacilityName" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieFacilityAddress" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieRouteA" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieRouteB" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieAuthorityName" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieAuthorityAddress" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieEALocalOffice" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieProposedVolume" />
              <Variable x:TypeArguments="x:String" Name="strEALocalOffice" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieDonorSite" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalDonorSite" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieReceiverSite" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieFacilityPostcode" />
              <Variable x:TypeArguments="sc:IEnumerable" Name="ieRecieverSiteIsHub" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:ReportStatus DisplayName="Report Status - Saving Email &amp; Attachments" sap:VirtualizedContainerService.HintSize="866.4,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_4" StatusText="[&quot;Extracting Declaration Data...&quot;]" />
            <ui:ForEach x:TypeArguments="x:Object" CurrentIndex="{x:Null}" DisplayName="For Each file in working folder:" sap:VirtualizedContainerService.HintSize="866.4,298.4" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[directory.getfiles(in_strWorkingFolder+&quot;\SavedEmail&quot;)]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="file" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="425.6,173.6" sap2010:WorkflowViewState.IdRef="Sequence_57">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:DeleteFileX DisplayName="Delete the File" sap:VirtualizedContainerService.HintSize="384,80.8" sap2010:WorkflowViewState.IdRef="DeleteFileX_1" Path="[file.ToString]" />
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
            </ui:ForEach>
            <ui:SaveMail DisplayName="Saving CL:AIRE email" FilePath="[in_strWorkingFolder+&quot;\SavedEmail\&quot;+(in_TransactionItem.Subject.tostring.Replace(&quot;:&quot;,&quot;.&quot;))+&quot;.eml&quot;]" sap:VirtualizedContainerService.HintSize="866.4,88" sap2010:WorkflowViewState.IdRef="SaveMail_1" MailMessage="[in_TransactionItem]" />
            <ui:SaveMailAttachments Attachments="{x:Null}" DisplayName="Save Email Attachments" FolderPath="[in_strWorkingFolder+&quot;\SavedEmail&quot;]" sap:VirtualizedContainerService.HintSize="866.4,88" sap2010:WorkflowViewState.IdRef="SaveMailAttachments_1" Message="[in_TransactionItem]" />
            <ui:ReportStatus DisplayName="Report Status - Extracting Declaration Data" sap:VirtualizedContainerService.HintSize="866.4,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_3" StatusText="[&quot;Extracting Declaration Data...&quot;]" />
            <Assign DisplayName="Get email body and remove new lines" sap:VirtualizedContainerService.HintSize="866.4,60" sap2010:WorkflowViewState.IdRef="Assign_3">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strEmailBody]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[in_TransactionItem.body.tostring.replace(environment.NewLine,(" "))]</InArgument>
              </Assign.Value>
            </Assign>
            <Assign DisplayName="Remove Extra Spaces" sap:VirtualizedContainerService.HintSize="866.4,60" sap2010:WorkflowViewState.IdRef="Assign_4">
              <Assign.To>
                <OutArgument x:TypeArguments="x:String">[strEmailBody]</OutArgument>
              </Assign.To>
              <Assign.Value>
                <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(strEmailBody.Trim, "\s+", " ")]</InArgument>
              </Assign.Value>
            </Assign>
            <ui:LogMessage DisplayName="Test - Email Body" sap:VirtualizedContainerService.HintSize="866.4,92.8" sap2010:WorkflowViewState.IdRef="LogMessage_2" Level="Trace" Message="[strEmailBody]" />
            <ui:Comment DisplayName="Comment - Common Regex" sap:VirtualizedContainerService.HintSize="866.4,56" sap2010:WorkflowViewState.IdRef="Comment_6" Text="// Common Across All Types" />
            <ui:MultipleAssign DisplayName="Multiple Assign - Regex Extraction" sap:VirtualizedContainerService.HintSize="866.4,381.6" sap2010:WorkflowViewState.IdRef="MultipleAssign_1">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_1">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieQPNumber]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=QP Number).+(?=8c\. I satisfy)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_2">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieSiteofOrigin]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Site of Origin).+(?=4\. Direct Transfer)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_3">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieDirectTransfer]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=4\. Direct Transfer).+(?=5\. Cluster Project)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieClusterProject]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Cluster Project \(including use of a fixed Soil Treatment Facility as a Hub site\)).+(?=2\. Proposed Volumes)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieQPName]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=8a\. QP Name).+(?=8b\. QP Number)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieAuthorityName]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Receiver Site Local Authority).+?(?=Local Authority Address)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieAuthorityAddress]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Local Authority Address).+?(?=Lead Contact Name)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_8">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieEALocalOffice]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Agency Address).+?(?=Contact Telephone)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieProposedVolume]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Proposed Volumes in m).+?(?=Additional comments on Proposed Volumes)")]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_206">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieRecieverSiteIsHub]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">["Nothing"]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <ui:MultipleAssign DisplayName="Multiple Assign - Conversion to String" sap:VirtualizedContainerService.HintSize="866.4,351.2" sap2010:WorkflowViewState.IdRef="MultipleAssign_2">
              <ui:MultipleAssign.AssignOperations>
                <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strQPNumber]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieQPNumber(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_11">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strSiteofOriginChecked]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieSiteofOrigin(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_12">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strDirectTransferChecked]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieDirectTransfer(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_13">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strClusterProjectChecked]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieClusterProject(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_14">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strQPName]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieQPName(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_15">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strAuthorityName]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieAuthorityName(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_16">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strAuthorityAddress]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieAuthorityAddress(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_17">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strEALocalOffice]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[ieEALocalOffice(0).tostring.trim]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                  <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_18">
                    <ui:AssignOperation.To>
                      <OutArgument x:TypeArguments="x:String">[strProposedVolume]</OutArgument>
                    </ui:AssignOperation.To>
                    <ui:AssignOperation.Value>
                      <InArgument x:TypeArguments="x:String">[system.text.RegularExpressions.regex.match(ieProposedVolume.tostring.Trim,\d+).Value]</InArgument>
                    </ui:AssignOperation.Value>
                  </ui:AssignOperation>
                </scg:List>
              </ui:MultipleAssign.AssignOperations>
            </ui:MultipleAssign>
            <ui:Comment DisplayName="Comment - Site of Origin" sap:VirtualizedContainerService.HintSize="866.4,56" sap2010:WorkflowViewState.IdRef="Comment_7" Text="// Common Across Site of Origin Types" />
            <If Condition="[strSiteofOriginChecked=&quot;Checked&quot;]" DisplayName="If site of origin is checked:" sap:VirtualizedContainerService.HintSize="866.4,1865.6" sap2010:WorkflowViewState.IdRef="If_5">
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="831.2,1676.8" sap2010:WorkflowViewState.IdRef="Sequence_20">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If Condition="[strSiteType=&quot;&quot;]" DisplayName="If site type is nothing:" sap:VirtualizedContainerService.HintSize="789.6,219.2" sap2010:WorkflowViewState.IdRef="If_4">
                    <If.Then>
                      <Assign DisplayName="Assign Site Type - Site of Origin" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_5">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strSiteType]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strSiteType+"Site of Origin"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <Assign DisplayName="Assign Site Type - Site of Origin" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_6">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strSiteType]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" Value="" />
                          </InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Else>
                  </If>
                  <ui:MultipleAssign DisplayName="Extract Site of Origin Information" sap:VirtualizedContainerService.HintSize="789.6,288.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_19">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieCustomerOperatorName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Developer #1 Company).+?(?=Address)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_20">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Site Address).+?(?=Postcode for Site of Origin)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_21">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Site Address).+?(?=Postcode for Site of Origin)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_22">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityPostcode]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Postcode for Site of Origin).+?(?=Grid Reference for Site of Origin)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_23">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieSiteofOriginAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Site Address).+(?=Grid Reference for Site of Origin)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_24">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieRouteA]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Route A: Land affected by contamination or suspected of being affected by contamination).+?(?=3b\. Route B: Land not suspected of being affected by contamination\.)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_25">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieRouteB]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=3b\. Route B: Land not suspected of being affected by contamination\.).+?(?=Site Address)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                  <ui:MultipleAssign DisplayName="Multiple Assign - Convert SoO info to String" sap:VirtualizedContainerService.HintSize="789.6,288.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_4">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_26">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strCustomerOperatorName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieCustomerOperatorName(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_27">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityName(0).tostring.trim.split(","c)(1)]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_28">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityAddress(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_29">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityPostcode]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityPostcode(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_30">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strSiteofOriginAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieSiteofOriginAddress(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_31">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strRouteA]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieRouteA(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_32">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strRouteB]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieRouteB(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                  <If Condition="[strRoute=&quot;&quot; or strRoute is Nothing]" DisplayName="If strRoute is Nothing" sap:VirtualizedContainerService.HintSize="789.6,219.2" sap2010:WorkflowViewState.IdRef="If_23">
                    <If.Else>
                      <Assign sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_41">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strRoute+"/"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Else>
                  </If>
                  <If Condition="[strRouteA=&quot;Checked&quot;]" DisplayName="If Route A is Checked" sap:VirtualizedContainerService.HintSize="789.6,408" sap2010:WorkflowViewState.IdRef="If_22">
                    <If.Then>
                      <Assign DisplayName="Set strRoute to &quot;Route A&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_37">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strRoute+"Route A"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <If Condition="[strRouteB=&quot;Checked&quot;]" DisplayName="If Route B is Checked" sap:VirtualizedContainerService.HintSize="483.2,248.8" sap2010:WorkflowViewState.IdRef="If_21">
                        <If.Then>
                          <Assign DisplayName="Set strRoute to &quot;Route B&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_38">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[strRoute+"Route B"]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Then>
                      </If>
                    </If.Else>
                  </If>
                </Sequence>
              </If.Then>
              <If.Else>
                <Sequence sap:VirtualizedContainerService.HintSize="241.6,84.8" sap2010:WorkflowViewState.IdRef="Sequence_21">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </Sequence>
              </If.Else>
            </If>
            <ui:Comment DisplayName="Comment - Direct Transfer" sap:VirtualizedContainerService.HintSize="866.4,56" sap2010:WorkflowViewState.IdRef="Comment_8" Text="// Common Across Direct Transfer Types" />
            <If Condition="[strDirectTransferChecked=&quot;Checked&quot;]" DisplayName="If direct transfer is checked:" sap:VirtualizedContainerService.HintSize="866.4,3222.4" sap2010:WorkflowViewState.IdRef="If_7">
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="831.2,3033.6" sap2010:WorkflowViewState.IdRef="Sequence_23">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:Int32" Name="intCounter" />
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieSection4" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If Condition="[strSiteType=&quot;&quot;]" DisplayName="If site type is nothing:" sap:VirtualizedContainerService.HintSize="789.6,219.2" sap2010:WorkflowViewState.IdRef="If_6">
                    <If.Then>
                      <Assign DisplayName="Assign Site Type - Direct Transfer" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_7">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strSiteType]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strSiteType+"Direct Transfer"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <Assign DisplayName="Assign Site Type - Direct Transfer" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strSiteType]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strSiteType+"/Direct Transfer"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Else>
                  </If>
                  <ui:MultipleAssign DisplayName="Extract Direct Transfer Information" sap:VirtualizedContainerService.HintSize="789.6,351.2" sap2010:WorkflowViewState.IdRef="MultipleAssign_5">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_111">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieSection4]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=4d. Receiver Sites).+(?=6a\. Local Authorities)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_33">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieCustomerOperatorName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieSection4(0).tostring,"(?&lt;=Company).+(?= Developer company address)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_34">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieSection4(0).tostring,"(?&lt;=Site Address ).*(?= Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_35">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieSection4(0).tostring,"(?&lt;=Site Address ).*(?= Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_36">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityPostcode]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieFacilityAddress(0).tostring,"([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9][A-Za-z]?))))\s?[0-9][A-Za-z]{2})")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_37">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieRouteA]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=4a. Route A: Direct use of clean naturally occurring soils with elevated levels of naturally occurring substances on another development site. ).+(?=4b. Route B: Direct use of clean naturally occurring soils on another development site.)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_38">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieRouteB]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=4b. Route B: Direct use of clean naturally occurring soils on another development site\.).+(?=4c\. Donor Sites)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_39">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieDonorSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Donor Site #1 Site Address).+?(?=Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_41">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieReceiverSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Receiver Site #1 Site Address).+?(?=Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                  <Assign DisplayName="Assign initial Counter" sap:VirtualizedContainerService.HintSize="789.6,60" sap2010:WorkflowViewState.IdRef="Assign_9">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Int32">2</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:InterruptibleWhile Condition="[strEmailBody.contains(&quot;Donor Site #&quot;+intCounter.ToString)]" DisplayName="While donor site corresponding to counter exists:" sap:VirtualizedContainerService.HintSize="789.6,492" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_1">
                    <ui:InterruptibleWhile.Body>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="472,324.8" sap2010:WorkflowViewState.IdRef="Sequence_22">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:String" Name="ie" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Get Additional Donor Site and Convert to String " sap:VirtualizedContainerService.HintSize="430.4,132" sap2010:WorkflowViewState.IdRef="MultipleAssign_17">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_112">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieAdditionalDonorSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Donor Site #"+intCounter.ToString+" Site Address).+?(?=Company)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_114">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[strAdditionalDonorSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">[strAdditionalDonorSite+"Donor Site #"+intCounter.tostring+" "+ieAdditionalDonorSite(0).tostring.trim+environment.NewLine+environment.newline]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <Assign DisplayName="Add 1 to intCounter" sap:VirtualizedContainerService.HintSize="430.4,60" sap2010:WorkflowViewState.IdRef="Assign_30">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:Int32">[intCounter+1]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </Sequence>
                    </ui:InterruptibleWhile.Body>
                  </ui:InterruptibleWhile>
                  <Assign DisplayName="Assign initial Counter" sap:VirtualizedContainerService.HintSize="789.6,60" sap2010:WorkflowViewState.IdRef="Assign_31">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Int32">2</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:InterruptibleWhile Condition="[strEmailBody.contains(&quot;Receiver Site #&quot;+intCounter.ToString)]" DisplayName="While reciever site corresponding to counter exists:" sap:VirtualizedContainerService.HintSize="789.6,492" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_3">
                    <ui:InterruptibleWhile.Body>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="472,324.8" sap2010:WorkflowViewState.IdRef="Sequence_41">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalReceiverSite" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Get Additional Reciever Site and Convert to String " sap:VirtualizedContainerService.HintSize="430.4,132" sap2010:WorkflowViewState.IdRef="MultipleAssign_18">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_115">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieAdditionalReceiverSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Receiver Site #"+intCounter.ToString+" Site Address).+?(?=Company)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_116">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[strAdditionalReceiverSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">[strAdditionalReceiverSite+"Receiver Site #"+intCounter.tostring+" "+ieAdditionalReceiverSite(0).tostring.trim+environment.NewLine+environment.newline]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <Assign DisplayName="Add 1 to intCounter" sap:VirtualizedContainerService.HintSize="430.4,60" sap2010:WorkflowViewState.IdRef="Assign_32">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:Int32">[intCounter+1]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </Sequence>
                    </ui:InterruptibleWhile.Body>
                  </ui:InterruptibleWhile>
                  <ui:MultipleAssign DisplayName="Multiple Assign - Convert Direct Transfer info to String" sap:VirtualizedContainerService.HintSize="789.6,319.2" sap2010:WorkflowViewState.IdRef="MultipleAssign_6">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_42">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strCustomerOperatorName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieCustomerOperatorName(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_43">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityName(0).tostring.trim.split(","c)(1)]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_44">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityAddress(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_45">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityPostcode]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityPostcode(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_117">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strRouteA]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieRouteA(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_118">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strRouteB]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieRouteB(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_119">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strDonorSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieDonorSite(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_120">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strReceiverSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieReceiverSite(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                  <If Condition="[strRoute=&quot;&quot; or strRoute is Nothing]" DisplayName="If strRoute is Nothing" sap:VirtualizedContainerService.HintSize="789.6,219.2" sap2010:WorkflowViewState.IdRef="If_24">
                    <If.Else>
                      <Assign sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_42">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strRoute+"/"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Else>
                  </If>
                  <If Condition="[strRouteA=&quot;Checked&quot;]" DisplayName="If Route A is Checked" sap:VirtualizedContainerService.HintSize="789.6,408" sap2010:WorkflowViewState.IdRef="If_26">
                    <If.Then>
                      <Assign DisplayName="Set strRoute to &quot;Route A&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_43">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strRoute+"Route A"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <If Condition="[strRouteB=&quot;Checked&quot;]" DisplayName="If Route B is Checked" sap:VirtualizedContainerService.HintSize="483.2,248.8" sap2010:WorkflowViewState.IdRef="If_25">
                        <If.Then>
                          <Assign DisplayName="Set strRoute to &quot;Route B&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_44">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[strRoute+"Route B"]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Then>
                      </If>
                    </If.Else>
                  </If>
                </Sequence>
              </If.Then>
              <If.Else>
                <Sequence sap:VirtualizedContainerService.HintSize="241.6,84.8" sap2010:WorkflowViewState.IdRef="Sequence_24">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </Sequence>
              </If.Else>
            </If>
            <ui:Comment DisplayName="Comment - Cluster Project" sap:VirtualizedContainerService.HintSize="866.4,56" sap2010:WorkflowViewState.IdRef="Comment_9" Text="// Common Across Cluster Project Types" />
            <If Condition="[strClusterProjectChecked=&quot;Checked&quot;]" DisplayName="If cluster project is checked:" sap:VirtualizedContainerService.HintSize="866.4,3415.2" sap2010:WorkflowViewState.IdRef="If_9">
              <If.Then>
                <Sequence sap:VirtualizedContainerService.HintSize="831.2,3226.4" sap2010:WorkflowViewState.IdRef="Sequence_26">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieRecieverSite" />
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieDonorSiteReference" />
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieDonorSiteAddress" />
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieDonorText" />
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieReceiverSiteReference" />
                    <Variable x:TypeArguments="x:Int32" Name="intCounter" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If Condition="[strSiteType=&quot;&quot;]" DisplayName="If site type is nothing:" sap:VirtualizedContainerService.HintSize="789.6,219.2" sap2010:WorkflowViewState.IdRef="If_8">
                    <If.Then>
                      <Assign DisplayName="Assign Site Type - Cluster" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_10">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strSiteType]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strSiteType+"Cluster Project"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <Assign DisplayName="Assign Site Type - Cluster" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_11">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strSiteType]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strSiteType+"/Cluster Project"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Else>
                  </If>
                  <ui:MultipleAssign DisplayName="Extract Cluster Project Information" sap:VirtualizedContainerService.HintSize="789.6,381.6" sap2010:WorkflowViewState.IdRef="MultipleAssign_7">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="16">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_46">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieRecieverSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Receiver Site #1).+?(?=Telephone)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_47">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieCustomerOperatorName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieRecieverSite(0).tostring,"(?&lt;=Company).+?(?=Address)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_48">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieRecieverSite(0).tostring,"(?&lt;=Site address).+?(?=Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_49">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieRecieverSite(0).tostring,"(?&lt;=Site address).+?(?=Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_50">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieFacilityPostcode]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieFacilityAddress(0).tostring,"([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9][A-Za-z]?))))\s?[0-9][A-Za-z]{2})")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_121">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieDonorSiteReference]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Donor Site #1 Site Reference).+?(?=Site address)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_123">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieDonorText]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody.tostring,"(?&lt;=Donor Site #1 Site Reference).+?(?=Telephone)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_122">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieDonorSiteAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieDonorText(0).tostring,"(?&lt;=Site address).+?(?=Name)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_125">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieReceiverSiteReference]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieRecieverSite(0).tostring,"(?&lt;=Site Reference).+?(?=Company)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_139">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieRecieverSiteIsHub]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Receiver Site is Hub).+?(?=Receiver Site)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                  <Assign DisplayName="Assign initial Counter" sap:VirtualizedContainerService.HintSize="789.6,60" sap2010:WorkflowViewState.IdRef="Assign_33">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Int32">2</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="789.6,60" sap2010:WorkflowViewState.IdRef="Assign_77">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strAdditionalDonorSite]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">
                        <Literal x:TypeArguments="x:String" Value="" />
                      </InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:InterruptibleWhile Condition="[strEmailBody.contains(&quot;Donor Site #&quot;+intCounter.ToString)]" DisplayName="While donor site corresponding to counter exists:" sap:VirtualizedContainerService.HintSize="789.6,554.4" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_4">
                    <ui:InterruptibleWhile.Body>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="472,387.2" sap2010:WorkflowViewState.IdRef="Sequence_42">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalDonorReference" />
                          <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalDonorAddress" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Get Additional Donor Site and Convert to String " sap:VirtualizedContainerService.HintSize="430.4,194.4" sap2010:WorkflowViewState.IdRef="MultipleAssign_19">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_128">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieDonorText]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody.tostring,"(?&lt;=Donor Site #"+intCounter.tostring+" Site Reference).+?(?=Telephone)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_126">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieAdditionalDonorReference]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieDonorText(0).tostring,".+?(?=Site address)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_132">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieAdditionalDonorAddress]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieDonorText(0).tostring,"(?&lt;=Site address).+?(?=Company)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_127">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[strAdditionalDonorSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">[strAdditionalDonorSite+ieAdditionalDonorReference(0).tostring.trim+", "+ieAdditionalDonorAddress(0).tostring.trim+environment.NewLine+environment.NewLine]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <Assign DisplayName="Add 1 to intCounter" sap:VirtualizedContainerService.HintSize="430.4,60" sap2010:WorkflowViewState.IdRef="Assign_34">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:Int32">[intCounter+1]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </Sequence>
                    </ui:InterruptibleWhile.Body>
                  </ui:InterruptibleWhile>
                  <Assign DisplayName="Assign initial Counter" sap:VirtualizedContainerService.HintSize="789.6,60" sap2010:WorkflowViewState.IdRef="Assign_35">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Int32">2</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:InterruptibleWhile Condition="[strEmailBody.contains(&quot;Receiver Site #&quot;+intCounter.ToString)]" DisplayName="While reciever site corresponding to counter exists:" sap:VirtualizedContainerService.HintSize="789.6,554.4" sap2010:WorkflowViewState.IdRef="InterruptibleWhile_5">
                    <ui:InterruptibleWhile.Body>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="472,387.2" sap2010:WorkflowViewState.IdRef="Sequence_43">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalReceiverSite" />
                          <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalReceiverReference" />
                          <Variable x:TypeArguments="sc:IEnumerable" Name="ieAdditionalReceiverAddress" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:MultipleAssign DisplayName="Get Additional Reciever Site and Convert to String " sap:VirtualizedContainerService.HintSize="430.4,194.4" sap2010:WorkflowViewState.IdRef="MultipleAssign_20">
                          <ui:MultipleAssign.AssignOperations>
                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_137">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieRecieverSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strEmailBody,"(?&lt;=Receiver Site #"+intCounter.ToString+").+?(?=Telephone)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_138">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieAdditionalReceiverReference]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieRecieverSite(0).tostring,"(?&lt;=Receiver Site #"+intCounter.tostring+" Site Reference).+?(?=Site address)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_129">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="sc:IEnumerable">[ieAdditionalReceiverAddress]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(ieReceiverSite(0).tostring,"(?&lt;=Site Address).+?(?=Company)")]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_130">
                                <ui:AssignOperation.To>
                                  <OutArgument x:TypeArguments="x:String">[strAdditionalReceiverSite]</OutArgument>
                                </ui:AssignOperation.To>
                                <ui:AssignOperation.Value>
                                  <InArgument x:TypeArguments="x:String">[strAdditionalReceiverSite+ieAdditionalReceiverReference(0).tostring.trim+", "+ieAdditionalReceiverAddress(0).tostring.trim+environment.NewLine+environment.NewLine]</InArgument>
                                </ui:AssignOperation.Value>
                              </ui:AssignOperation>
                            </scg:List>
                          </ui:MultipleAssign.AssignOperations>
                        </ui:MultipleAssign>
                        <Assign DisplayName="Add 1 to intCounter" sap:VirtualizedContainerService.HintSize="430.4,60" sap2010:WorkflowViewState.IdRef="Assign_36">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:Int32">[intCounter]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:Int32">[intCounter+1]</InArgument>
                          </Assign.Value>
                        </Assign>
                      </Sequence>
                    </ui:InterruptibleWhile.Body>
                  </ui:InterruptibleWhile>
                  <ui:MultipleAssign DisplayName="Multiple Assign - Convert Cluster info to String" sap:VirtualizedContainerService.HintSize="789.6,256.8" sap2010:WorkflowViewState.IdRef="MultipleAssign_8">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_51">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strCustomerOperatorName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieCustomerOperatorName(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_52">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityName]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityName(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_53">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityAddress]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityAddress(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_54">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strFacilityPostcode]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieFacilityPostcode(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_124">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strDonorSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieDonorSiteReference(0).tostring.trim+", "+ieDonorSiteAddress(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_131">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strReceiverSite]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieReceiverSiteReference(0).tostring.trim+", "+ieFacilityAddress(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                  <If Condition="[strRoute=&quot;&quot; or strRoute is Nothing]" DisplayName="If strRoute is Nothing" sap:VirtualizedContainerService.HintSize="789.6,219.2" sap2010:WorkflowViewState.IdRef="If_27">
                    <If.Then>
                      <Assign DisplayName="Assign N/A" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_53">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">N/A</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <Assign DisplayName="Add slash" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_45">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strRoute+"/"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Else>
                  </If>
                  <If Condition="[strRouteA=&quot;Checked&quot;]" DisplayName="If Route A is Checked" sap:VirtualizedContainerService.HintSize="789.6,408" sap2010:WorkflowViewState.IdRef="If_29">
                    <If.Then>
                      <Assign DisplayName="Set strRoute to &quot;Route A&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_46">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[strRoute+"Route A"]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </If.Then>
                    <If.Else>
                      <If Condition="[strRouteB=&quot;Checked&quot;]" DisplayName="If Route B is Checked" sap:VirtualizedContainerService.HintSize="483.2,248.8" sap2010:WorkflowViewState.IdRef="If_28">
                        <If.Then>
                          <Assign DisplayName="Set strRoute to &quot;Route B&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_47">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[strRoute]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[strRoute+"Route B"]</InArgument>
                            </Assign.Value>
                          </Assign>
                        </If.Then>
                      </If>
                    </If.Else>
                  </If>
                </Sequence>
              </If.Then>
              <If.Else>
                <Sequence sap:VirtualizedContainerService.HintSize="241.6,84.8" sap2010:WorkflowViewState.IdRef="Sequence_27">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </Sequence>
              </If.Else>
            </If>
            <If Condition="[ieRecieverSiteIsHub(0).tostring.trim=&quot;Checked&quot;]" DisplayName="If Receiver Site is Hub" sap:VirtualizedContainerService.HintSize="866.4,219.2" sap2010:WorkflowViewState.IdRef="If_32">
              <If.Then>
                <Assign DisplayName="Set Reciever Hub to &quot;Yes&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_54">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[strRecieverHubTreatment]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">Yes</InArgument>
                  </Assign.Value>
                </Assign>
              </If.Then>
              <If.Else>
                <Assign DisplayName="Set Reciever Hub to &quot;No&quot;" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_55">
                  <Assign.To>
                    <OutArgument x:TypeArguments="x:String">[strRecieverHubTreatment]</OutArgument>
                  </Assign.To>
                  <Assign.Value>
                    <InArgument x:TypeArguments="x:String">No</InArgument>
                  </Assign.Value>
                </Assign>
              </If.Else>
            </If>
          </Sequence>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID3">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">200,365.3</av:Point>
                  <av:Size x:Key="ShapeSize">200,69.3333333333333</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">300,434.1 300,484.1</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Sequence DisplayName="API requests - Postcode/Easimap" sap:VirtualizedContainerService.HintSize="200,69.3333333333333" sap2010:WorkflowViewState.IdRef="Sequence_47">
                <Sequence.Variables>
                  <Variable x:TypeArguments="x:Boolean" Name="booStarterFolderExists" />
                  <Variable x:TypeArguments="x:String" Name="strAPIText" />
                  <Variable x:TypeArguments="njl:JObject" Name="JsonObjectAPI" />
                  <Variable x:TypeArguments="njl:JArray" Name="JarrayResults" />
                  <Variable x:TypeArguments="sc:IEnumerable" Name="ieEastings" />
                  <Variable x:TypeArguments="sc:IEnumerable" Name="ieNorthings" />
                  <Variable x:TypeArguments="x:String" Name="strEastings" />
                  <Variable x:TypeArguments="x:String" Name="strNorthings" />
                  <Variable x:TypeArguments="x:String" Name="strManagementArea" />
                  <Variable x:TypeArguments="sd1:DataTable" Name="datEmailAddresses" />
                  <Variable x:TypeArguments="x:String" Name="strCounty" />
                </Sequence.Variables>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:ReportStatus DisplayName="Report Status - Converting Postcode to North Easting" sap:VirtualizedContainerService.HintSize="696,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_5" StatusText="[&quot;Converting postcode to northing/easting...&quot;]" />
                <Sequence DisplayName="Postcode Converter API" sap:VirtualizedContainerService.HintSize="696,398.4" sap2010:WorkflowViewState.IdRef="Sequence_44">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ui:HttpClient Body="{x:Null}" ClientCertificate="{x:Null}" ClientCertificatePassword="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" ContinueOnError="{x:Null}" FileAttachments="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseAttachment="{x:Null}" ResponseHeaders="{x:Null}" SecureClientCertificatePassword="{x:Null}" SecurePassword="{x:Null}" StatusCode="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" AuthenticationType="None" BodyFormat="application/xml" DisplayName="HTTP Request - Postcodes.io" EnableSSLVerification="True" EndPoint="[&quot;http://api.postcodes.io/postcodes/&quot;+strFacilityPostcode.replace(&quot; &quot;,&quot;%20&quot;)]" sap:VirtualizedContainerService.HintSize="430.4,71.2" sap2010:WorkflowViewState.IdRef="HttpClient_1" Method="GET" Result="[strAPIText]" TimeoutMS="6000">
                    <ui:HttpClient.Attachments>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Attachments>
                    <ui:HttpClient.Cookies>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Cookies>
                    <ui:HttpClient.Headers>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Headers>
                    <ui:HttpClient.Parameters>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Parameters>
                    <ui:HttpClient.UrlSegments>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.UrlSegments>
                  </ui:HttpClient>
                  <ui:MultipleAssign DisplayName="Multiple Assign - Easting/Northing" sap:VirtualizedContainerService.HintSize="430.4,194.4" sap2010:WorkflowViewState.IdRef="MultipleAssign_21">
                    <ui:MultipleAssign.AssignOperations>
                      <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_140">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieEastings]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strAPIText,"(?&lt;=""eastings"":).+?(?=,)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_141">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="sc:IEnumerable">[ieNorthings]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strAPIText,"(?&lt;=""northings"":).+?(?=,)")]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_142">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strEastings]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieEastings(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                        <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_143">
                          <ui:AssignOperation.To>
                            <OutArgument x:TypeArguments="x:String">[strNorthings]</OutArgument>
                          </ui:AssignOperation.To>
                          <ui:AssignOperation.Value>
                            <InArgument x:TypeArguments="x:String">[ieNorthings(0).tostring.trim]</InArgument>
                          </ui:AssignOperation.Value>
                        </ui:AssignOperation>
                      </scg:List>
                    </ui:MultipleAssign.AssignOperations>
                  </ui:MultipleAssign>
                </Sequence>
                <ui:ReportStatus DisplayName="Report Status - Easimap API" sap:VirtualizedContainerService.HintSize="696,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_6" StatusText="[&quot;Easimap - Obtaining EA Water Management Area&quot;]" />
                <Sequence DisplayName="Easimap API - WM Area" sap:VirtualizedContainerService.HintSize="696,1236" sap2010:WorkflowViewState.IdRef="Sequence_46">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:String" Name="strAPIURL" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign DisplayName="Assign initial URL - Easimap" sap:VirtualizedContainerService.HintSize="654.4,60" sap2010:WorkflowViewState.IdRef="Assign_48">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strAPIURL]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">["https://eagis.cloud.esriuk.com/server/rest/services/boundaries/EA_Boundaries/MapServer/identify?geometry=REPLACEEASTINGS%2CREPLACENORTHINGS&amp;geometryType=esriGeometryPoint&amp;sr=&amp;layers=1&amp;layerDefs=&amp;time=&amp;timeRelation=esriTimeRelationOverlaps&amp;layerTimeOptions=&amp;tolerance=1&amp;mapExtent=403000%2C+245000%2C+404000%2C+248000&amp;imageDisplay=600%2C550%2C96&amp;returnGeometry=false&amp;maxAllowableOffset=&amp;geometryPrecision=&amp;dynamicLayers=&amp;returnZ=false&amp;returnM=false&amp;gdbVersion=&amp;historicMoment=&amp;returnUnformattedValues=false&amp;returnFieldName=false&amp;datumTransformations=&amp;layerParameterValues=&amp;mapRangeValues=&amp;layerRangeValues=&amp;clipping=&amp;spatialFilter=&amp;f=pjson"]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Add northing and easting" sap:VirtualizedContainerService.HintSize="654.4,60" sap2010:WorkflowViewState.IdRef="Assign_49">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strAPIURL]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[strAPIURL.Replace("REPLACEEASTINGS",strEastings).Replace("REPLACENORTHINGS",strNorthings)]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:HttpClient Body="{x:Null}" ClientCertificate="{x:Null}" ClientCertificatePassword="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" ContinueOnError="{x:Null}" FileAttachments="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseAttachment="{x:Null}" ResponseHeaders="{x:Null}" SecureClientCertificatePassword="{x:Null}" SecurePassword="{x:Null}" StatusCode="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" AuthenticationType="None" BodyFormat="application/xml" DisplayName="HTTP Request - Easimap API" EnableSSLVerification="True" EndPoint="[strAPIURL]" sap:VirtualizedContainerService.HintSize="654.4,71.2" sap2010:WorkflowViewState.IdRef="HttpClient_2" Method="GET" Result="[strAPIText]" TimeoutMS="6000">
                    <ui:HttpClient.Attachments>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Attachments>
                    <ui:HttpClient.Cookies>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Cookies>
                    <ui:HttpClient.Headers>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Headers>
                    <ui:HttpClient.Parameters>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Parameters>
                    <ui:HttpClient.UrlSegments>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.UrlSegments>
                  </ui:HttpClient>
                  <ui:DeserializeJson x:TypeArguments="njl:JObject" DisplayName="Deserialize JSON - API" sap:VirtualizedContainerService.HintSize="654.4,60" sap2010:WorkflowViewState.IdRef="DeserializeJson`1_1" JsonObject="[JsonObjectAPI]" JsonString="[strAPIText]" />
                  <ui:DeserializeJsonArray DisplayName="Deserialize JSON Array - API" sap:VirtualizedContainerService.HintSize="654.4,60" sap2010:WorkflowViewState.IdRef="DeserializeJsonArray_1" JsonArray="[JarrayResults]" JsonString="[JsonObjectAPI(&quot;results&quot;).ToString]" />
                  <ui:ForEach x:TypeArguments="njl:JObject" CurrentIndex="{x:Null}" DisplayName="For Each in Jarray" sap:VirtualizedContainerService.HintSize="654.4,632" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[JarrayResults]">
                    <ui:ForEach.Body>
                      <ActivityAction x:TypeArguments="njl:JObject">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="njl:JObject" Name="item" />
                        </ActivityAction.Argument>
                        <If Condition="[item(&quot;attributes&quot;).ToString.Contains(&quot;EA WM Area Long Name&quot;)]" sap:VirtualizedContainerService.HintSize="619.2,507.2" sap2010:WorkflowViewState.IdRef="If_30">
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="375.2,348" sap2010:WorkflowViewState.IdRef="Sequence_45">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign Water Management Area" sap:VirtualizedContainerService.HintSize="333.6,60" sap2010:WorkflowViewState.IdRef="Assign_50">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[strManagementArea]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[item("attributes")("EA WM Area Long Name").ToString]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:LogMessage DisplayName="Log Message - New" sap:VirtualizedContainerService.HintSize="333.6,92.8" sap2010:WorkflowViewState.IdRef="LogMessage_1" Level="Info" Message="[&quot;New Area: &quot;+strManagementArea]" />
                              <ui:Break DisplayName="Break - End Sequence" sap:VirtualizedContainerService.HintSize="333.6,22.4" sap2010:WorkflowViewState.IdRef="Break_2" />
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Throw DisplayName="Throw BRE - API Error" Exception="[New BusinessRuleException(&quot;The API text does not contain a water management area. &quot;+strAPIText)]" sap:VirtualizedContainerService.HintSize="200,22.4" sap2010:WorkflowViewState.IdRef="Throw_1" />
                          </If.Else>
                        </If>
                      </ActivityAction>
                    </ui:ForEach.Body>
                  </ui:ForEach>
                </Sequence>
                <Sequence DisplayName="Easimap API - County" sap:VirtualizedContainerService.HintSize="696,852.8" sap2010:WorkflowViewState.IdRef="Sequence_61">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:String" Name="strAPIURL" />
                    <Variable x:TypeArguments="sc:IEnumerable" Name="ieCounty" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign DisplayName="Assign initial URL - Easimap" sap:VirtualizedContainerService.HintSize="483.2,60" sap2010:WorkflowViewState.IdRef="Assign_56">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strAPIURL]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">["https://eagis.cloud.esriuk.com/server/rest/services/boundaries/Admin_boundaries/MapServer/0/query?where=&amp;text=&amp;objectIds=&amp;time=&amp;timeRelation=esriTimeRelationOverlaps&amp;geometry=REPLACEEASTINGS+%2C+REPLACENORTHINGS&amp;geometryType=esriGeometryPoint&amp;inSR=&amp;spatialRel=esriSpatialRelIntersects&amp;distance=&amp;units=esriSRUnit_Foot&amp;relationParam=&amp;outFields=&amp;returnGeometry=false&amp;returnTrueCurves=false&amp;maxAllowableOffset=&amp;geometryPrecision=&amp;outSR=&amp;havingClause=&amp;returnIdsOnly=false&amp;returnCountOnly=false&amp;orderByFields=&amp;groupByFieldsForStatistics=&amp;outStatistics=&amp;returnZ=false&amp;returnM=false&amp;gdbVersion=&amp;historicMoment=&amp;returnDistinctValues=false&amp;resultOffset=&amp;resultRecordCount=&amp;returnExtentOnly=false&amp;sqlFormat=none&amp;datumTransformation=&amp;parameterValues=&amp;rangeValues=&amp;quantizationParameters=&amp;featureEncoding=esriDefault&amp;f=pjson"]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Add northing and easting" sap:VirtualizedContainerService.HintSize="483.2,60" sap2010:WorkflowViewState.IdRef="Assign_57">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strAPIURL]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[strAPIURL.Replace("REPLACEEASTINGS",strEastings).Replace("REPLACENORTHINGS",strNorthings)]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:HttpClient Body="{x:Null}" ClientCertificate="{x:Null}" ClientCertificatePassword="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" ContinueOnError="{x:Null}" FileAttachments="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseAttachment="{x:Null}" ResponseHeaders="{x:Null}" SecureClientCertificatePassword="{x:Null}" SecurePassword="{x:Null}" StatusCode="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" AuthenticationType="None" BodyFormat="application/xml" DisplayName="HTTP Request - Easimap API" EnableSSLVerification="True" EndPoint="[strAPIURL]" sap:VirtualizedContainerService.HintSize="483.2,71.2" sap2010:WorkflowViewState.IdRef="HttpClient_3" Method="GET" Result="[strAPIText]" TimeoutMS="6000">
                    <ui:HttpClient.Attachments>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Attachments>
                    <ui:HttpClient.Cookies>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Cookies>
                    <ui:HttpClient.Headers>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Headers>
                    <ui:HttpClient.Parameters>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.Parameters>
                    <ui:HttpClient.UrlSegments>
                      <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                    </ui:HttpClient.UrlSegments>
                  </ui:HttpClient>
                  <Assign DisplayName="Get County" sap:VirtualizedContainerService.HintSize="483.2,60" sap2010:WorkflowViewState.IdRef="Assign_62">
                    <Assign.To>
                      <OutArgument x:TypeArguments="sc:IEnumerable">[ieCounty]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="sc:IEnumerable">[system.text.RegularExpressions.regex.matches(strAPItext,"(?&lt;=""area_name"": "")(.*)+(?=""\s{3})")]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Convert County to String" sap:VirtualizedContainerService.HintSize="483.2,60" sap2010:WorkflowViewState.IdRef="Assign_63">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[strCounty]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[ieCounty(0).tostring]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <If Condition="[strCounty is Nothing]" DisplayName="If County is Nothing" sap:VirtualizedContainerService.HintSize="483.2,248.8" sap2010:WorkflowViewState.IdRef="If_34">
                    <If.Then>
                      <Throw DisplayName="Throw BRE - API Error" Exception="[New BusinessRuleException(&quot;The API text does not contain a county. &quot;+strAPIText)]" sap:VirtualizedContainerService.HintSize="200,22.4" sap2010:WorkflowViewState.IdRef="Throw_3" />
                    </If.Then>
                    <If.Else>
                      <Sequence sap2010:WorkflowViewState.IdRef="Sequence_63">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Sequence>
                    </If.Else>
                  </If>
                </Sequence>
                <ui:ReportStatus DisplayName="Report Status - WM Area Email Address" sap:VirtualizedContainerService.HintSize="696,67.2" sap2010:WorkflowViewState.IdRef="ReportStatus_7" StatusText="[&quot;Cross referencing WM area - obtaining area email&quot;]" />
                <If Condition="[strManagementArea=&quot;Cumbria and Lancashire&quot;]" DisplayName="If the WM area is Cumbria and Lancashire" sap:VirtualizedContainerService.HintSize="696,408" sap2010:WorkflowViewState.IdRef="If_35">
                  <If.Then>
                    <If Condition="[strCounty.contains(&quot;Cumbria&quot;)]" DisplayName="If the county is Cumbria" sap:VirtualizedContainerService.HintSize="568.8,219.2" sap2010:WorkflowViewState.IdRef="If_37">
                      <If.Then>
                        <Assign DisplayName="Set Management Area to Cumbria" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_64">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strManagementArea]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">Cumbria</InArgument>
                          </Assign.Value>
                        </Assign>
                      </If.Then>
                      <If.Else>
                        <Assign DisplayName="Set Management Area to Lancashire" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_65">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strManagementArea]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">Lancashire</InArgument>
                          </Assign.Value>
                        </Assign>
                      </If.Else>
                    </If>
                  </If.Then>
                  <If.Else>
                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_65">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </Sequence>
                  </If.Else>
                </If>
                <If Condition="[strManagementArea=&quot;Devon and Cornwall&quot;]" DisplayName="If WM area is Devon and Cornwall" sap:VirtualizedContainerService.HintSize="696,408" sap2010:WorkflowViewState.IdRef="If_36">
                  <If.Then>
                    <If Condition="[strCounty.contains(&quot;Devon&quot;)]" DisplayName="If the couunty is Devon" sap:VirtualizedContainerService.HintSize="568.8,219.2" sap2010:WorkflowViewState.IdRef="If_38">
                      <If.Then>
                        <Assign DisplayName="Set Management Area to Devon" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_66">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strManagementArea]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">Devon</InArgument>
                          </Assign.Value>
                        </Assign>
                      </If.Then>
                      <If.Else>
                        <Assign DisplayName="Set Management Area to Cornwall" sap:VirtualizedContainerService.HintSize="262.4,60" sap2010:WorkflowViewState.IdRef="Assign_67">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[strManagementArea]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">Cornwall</InArgument>
                          </Assign.Value>
                        </Assign>
                      </If.Else>
                    </If>
                  </If.Then>
                  <If.Else>
                    <Sequence sap2010:WorkflowViewState.IdRef="Sequence_66">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </Sequence>
                  </If.Else>
                </If>
                <ui:BuildDataTable DataTable="[datEmailAddresses]" DisplayName="Build Data Table - datEmailAdresses" sap:VirtualizedContainerService.HintSize="696,60" sap2010:WorkflowViewState.IdRef="BuildDataTable_2" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Area&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Email&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Area_x0020_Code&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;100&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Lancashire&lt;/Area&gt;&#xA;    &lt;Email&gt;EMENVIRONMENT@environment-agency.gov.uk; GWCL_CMBLNC@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;CLA&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Devon&lt;/Area&gt;&#xA;    &lt;Email&gt;Devon_EM@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;DCS&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;East Midlands&lt;/Area&gt;&#xA;    &lt;Email&gt;ijaz.sawar@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;EMD&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Greater Manchester and Cheshire&lt;/Area&gt;&#xA;    &lt;Email&gt;EMQueriesNWSouth@environment-agency.gov.uk; GWCL_GMMC@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;GMC&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Hertfordshire and North London&lt;/Area&gt;&#xA;    &lt;Email&gt;HNL_WASTE@environment-agency.gov.uk; gwcla.hatfield@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;HNL&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Kent and South London&lt;/Area&gt;&#xA;    &lt;Email&gt;sirkka-liisa.luoto@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;KSL&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Lincolnshire and Northamptonshire&lt;/Area&gt;&#xA;    &lt;Email&gt;em.northern@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;LNA&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Northeast Newcastle&lt;/Area&gt;&#xA;    &lt;Email&gt;NE-Waste@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;NEA&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Solent and South Downs&lt;/Area&gt;&#xA;    &lt;Email&gt;SSDGroundwaterProtection@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;SSD&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;West Thames&lt;/Area&gt;&#xA;    &lt;Email&gt;Thames_EPR_Waste@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;THM&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Wessex&lt;/Area&gt;&#xA;    &lt;Email&gt;wessex.waste@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;WSX&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Staffordshire Warwickshire and West Midlands&lt;/Area&gt;&#xA;    &lt;Email&gt;judy.roberts@environment-agency.gov.uk; mark.pearson@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;WMD&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Yorkshire&lt;/Area&gt;&#xA;    &lt;Email&gt;yorkshirewaste@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;YOR&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Northumberland Durham and Tees&lt;/Area&gt;&#xA;    &lt;Email&gt;NE-Waste@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;NEA&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Essex Norfolk and Suffolk&lt;/Area&gt;&#xA;    &lt;Email&gt;ANEM-N-Norfolk@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;EAN&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Cambridgeshire and Bedfordshire&lt;/Area&gt;&#xA;    &lt;Email&gt;liz.braybrook@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;EAN&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Derbyshire Nottinghamshire and Leicestershire&lt;/Area&gt;&#xA;    &lt;Email&gt;ijaz.sawar@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;EMD&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Shropshire Herefordshire Worcestershire and Gloucestershire&lt;/Area&gt;&#xA;    &lt;Email&gt;judy.roberts@environment-agency.gov.uk; mark.pearson@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;WMD&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Greater Manchester Merseyside and Cheshire&lt;/Area&gt;&#xA;    &lt;Email&gt;EMQueriesNWSouth@environment-agency.gov.uk; GWCL_GMMC@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;GMC&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Cumbria&lt;/Area&gt;&#xA;    &lt;Email&gt;EMENVIRONMENT@environment-agency.gov.uk; GWCL_CMBLNC@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;CLA&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;  &lt;TableName&gt;&#xA;    &lt;Area&gt;Cornwall&lt;/Area&gt;&#xA;    &lt;Email&gt;Cornwall_EM@environment-agency.gov.uk&lt;/Email&gt;&#xA;    &lt;Area_x0020_Code&gt;DCS&lt;/Area_x0020_Code&gt;&#xA;  &lt;/TableName&gt;&#xA;&lt;/NewDataSet&gt;" />
                <ui:ForEachRow ColumnNames="{x:Null}" CurrentIndex="{x:Null}" DataTable="[datEmailAddresses]" DisplayName="Get corresponding area email address" sap:VirtualizedContainerService.HintSize="696,1201.6" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                  <ui:ForEachRow.Body>
                    <ActivityAction x:TypeArguments="sd1:DataRow">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="sd1:DataRow" Name="row" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="524.8,1080.8" sap2010:WorkflowViewState.IdRef="Sequence_55">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:String" Name="strArea" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:GetRowItem Column="{x:Null}" ColumnName="{x:Null}" ColumnIndex="0" DisplayName="Get Row Item - Area" sap:VirtualizedContainerService.HintSize="483.2,188" sap2010:WorkflowViewState.IdRef="GetRowItem_2" Row="[row]">
                          <ui:GetRowItem.Value>
                            <OutArgument x:TypeArguments="x:String">[strArea]</OutArgument>
                          </ui:GetRowItem.Value>
                        </ui:GetRowItem>
                        <If Condition="[strArea=strManagementArea]" DisplayName="If area and management area match:" sap:VirtualizedContainerService.HintSize="483.2,760" sap2010:WorkflowViewState.IdRef="If_39">
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="375.2,571.2" sap2010:WorkflowViewState.IdRef="Sequence_69">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:GetRowItem Column="{x:Null}" ColumnName="{x:Null}" ColumnIndex="2" DisplayName="Get Row Item - Area Code" sap:VirtualizedContainerService.HintSize="333.6,188" sap2010:WorkflowViewState.IdRef="GetRowItem_4" Row="[row]">
                                <ui:GetRowItem.Value>
                                  <OutArgument x:TypeArguments="x:String">[strManagementArea]</OutArgument>
                                </ui:GetRowItem.Value>
                              </ui:GetRowItem>
                              <ui:GetRowItem Column="{x:Null}" ColumnName="{x:Null}" ColumnIndex="1" DisplayName="Get Row Item - Area Email" sap:VirtualizedContainerService.HintSize="333.6,188" sap2010:WorkflowViewState.IdRef="GetRowItem_3" Row="[row]">
                                <ui:GetRowItem.Value>
                                  <OutArgument x:TypeArguments="x:String">[strAreaEmail]</OutArgument>
                                </ui:GetRowItem.Value>
                              </ui:GetRowItem>
                              <ui:Break sap:VirtualizedContainerService.HintSize="333.6,22.4" sap2010:WorkflowViewState.IdRef="Break_4" />
                            </Sequence>
                          </If.Then>
                        </If>
                      </Sequence>
                    </ActivityAction>
                  </ui:ForEachRow.Body>
                </ui:ForEachRow>
                <If Condition="[Cbool(io_Config(&quot;Pausepoint 1&quot;))=True]" DisplayName="If Pausepoint 1 is Enabled:" sap:VirtualizedContainerService.HintSize="696,302.4" sap2010:WorkflowViewState.IdRef="If_43">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <ui:InvokeWorkflowFile ArgumentsVariable="{x:Null}" ContinueOnError="{x:Null}" DisplayName="Invoke Pausepoint1 workflow" sap:VirtualizedContainerService.HintSize="336,113.6" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_3" UnSafe="False" WorkflowFileName="Process/Process Subflows/Pausepoint1.xaml">
                      <ui:InvokeWorkflowFile.Arguments>
                        <InArgument x:TypeArguments="x:String" x:Key="in_strPopupMessage">["&lt;h1&gt;Check Contacting Area&lt;/h1&gt;&lt;br&gt;&lt;p&gt;The robot has identified the below contact area and email. Please check if this is correct and click continue if so.&lt;br&gt;&lt;br&gt;&lt;b&gt;Area Code: &lt;/b&gt;"+strManagementArea+"&lt;br&gt;&lt;b&gt;Area Email: &lt;/b&gt;"+strAreaEmail]</InArgument>
                      </ui:InvokeWorkflowFile.Arguments>
                    </ui:InvokeWorkflowFile>
                  </If.Then>
                </If>
                <ui:BuildDataTable DataTable="[datLineToAdd]" DisplayName="Build Data Table - Line for Master Sheet" sap:VirtualizedContainerService.HintSize="696,60" sap2010:WorkflowViewState.IdRef="BuildDataTable_3" TableInfo="&lt;NewDataSet&gt;&#xA;  &lt;xs:schema id=&quot;NewDataSet&quot; xmlns=&quot;&quot; xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:msdata=&quot;urn:schemas-microsoft-com:xml-msdata&quot;&gt;&#xA;    &lt;xs:element name=&quot;NewDataSet&quot; msdata:IsDataSet=&quot;true&quot; msdata:MainDataTable=&quot;TableName&quot; msdata:UseCurrentLocale=&quot;true&quot;&gt;&#xA;      &lt;xs:complexType&gt;&#xA;        &lt;xs:choice minOccurs=&quot;0&quot; maxOccurs=&quot;unbounded&quot;&gt;&#xA;          &lt;xs:element name=&quot;TableName&quot;&gt;&#xA;            &lt;xs:complexType&gt;&#xA;              &lt;xs:sequence&gt;&#xA;                &lt;xs:element name=&quot;Reference_x0020_No&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Folder_x0020_Created&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Date_x0020_Received&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Time_x0020_Received&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Name_x0020_of_x0020_Qualified_x0020_Person&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Site_x0020_Type&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Route&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Site_x0020_of_x0020_origin_x0020_-_x0020_site_x0020_name_x0020__x0026__x0020_addess&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Local_x0020_Authority_x0020_Name&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Local_x0020_Authority_x0020_Address&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;EA_x0020_Local_x0020_Office&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;EA_x0020_Area&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Date_x0020_Processed&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Notes&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Donor_x0020_Site_x0020_name_x0020_and_x0020_address&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Additional_x0020_Donor_x0020_Site_x0020_name_x0020_and_x0020_address&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Name_x0020_and_x0020_Address_x0020_of_x0020_Receiver_x0020_Site&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Additional_x0020_Name_x0020_and_x0020_address_x0020_of_x0020_reciever_x0020_site&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Is_x0020_Hub_x0020_site_x0020_being_x0020_used_x0020_for_x0020_treatment&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;                &lt;xs:element name=&quot;Proposed_x0020_Volumes&quot; msdata:Caption=&quot;&quot; minOccurs=&quot;0&quot;&gt;&#xA;                  &lt;xs:simpleType&gt;&#xA;                    &lt;xs:restriction base=&quot;xs:string&quot;&gt;&#xA;                      &lt;xs:maxLength value=&quot;10000&quot; /&gt;&#xA;                    &lt;/xs:restriction&gt;&#xA;                  &lt;/xs:simpleType&gt;&#xA;                &lt;/xs:element&gt;&#xA;              &lt;/xs:sequence&gt;&#xA;            &lt;/xs:complexType&gt;&#xA;          &lt;/xs:element&gt;&#xA;        &lt;/xs:choice&gt;&#xA;      &lt;/xs:complexType&gt;&#xA;    &lt;/xs:element&gt;&#xA;  &lt;/xs:schema&gt;&#xA;&lt;/NewDataSet&gt;" />
                <ui:AddDataRow DataRow="{x:Null}" ArrayRow="[{strPermitNumber,&quot;Yes&quot;,Cdate(in_TransactionItem.headers(&quot;Date&quot;).ToString).ToString(&quot;dd/MM/yyyy&quot;),Cdate(in_TransactionItem.headers(&quot;Date&quot;).ToString).ToString(&quot;hh:mm:ss&quot;),strQPName,strRoute,strSiteOfOriginAddress,StrAuthorityName,strAuthorityAddress,strManagementArea,datetime.now.tostring(&quot;dd/MM/yyyy&quot;),strDonorSite,strAdditionalDonorSite,strReceiverSite,strAdditionalReceiverSite,strRecieverHubTreatment,strProposedVolume}]" DataTable="[datLineToAdd]" DisplayName="Add Data Row - New Line " sap:VirtualizedContainerService.HintSize="696,188" sap2010:WorkflowViewState.IdRef="AddDataRow_2" />
              </Sequence>
              <FlowStep.Next>
                <x:Reference>__ReferenceID1</x:Reference>
              </FlowStep.Next>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID2</x:Reference>
    <x:Reference>__ReferenceID3</x:Reference>
    <x:Reference>__ReferenceID4</x:Reference>
    <x:Reference>__ReferenceID5</x:Reference>
    <x:Reference>__ReferenceID6</x:Reference>
    <x:Reference>__ReferenceID7</x:Reference>
    <x:Reference>__ReferenceID8</x:Reference>
    <x:Reference>__ReferenceID9</x:Reference>
  </Flowchart>
</Activity>